function initialize(){var a=document.getElementById("map_canvas"),b={center:new google.maps.LatLng(setting.latitude,setting.longitude),zoom:14,mapTypeId:google.maps.MapTypeId.ROADMAP},c=new google.maps.Map(a,b),d=setting.map_pin;new google.maps.Marker({position:{lat:setting.latitude,lng:setting.longitude},map:c,icon:d})}function initMap(a,b,c){var d={lat:parseFloat(b),lng:parseFloat(c)},e=new google.maps.Map(document.getElementById("map"),{center:d,scrollwheel:!1,zoom:12});new google.maps.Marker({map:e,position:d,title:a,icon:setting.map_pin})}function incCounter(){var a=$$(".shopCart .items_counter");count++,a.text(count)}function decCounter(){var a=$$(".shopCart .items_counter");count>0&&count--,a.text(count)}function getItem(a){function b(a){for(var b=0;b<menuCategories.length;b++)for(var c=0;c<menuCategories[b].items.length;c++)if(item=menuCategories[b].items[c],item.product_id==a)return item;return{}}return"undefined"!=typeof menuCategories?b(a):void $$.getMenu(function(c){return b(a)})}function addToCard(a,b){var c=getItem(a);c.in_cart=!0,c.quantity=1,c.opts={},cartItems.push({product_id:c.product_id,quantity:c.quantity,options:c.opts?c.opts:{},note:c.note?c.note:""}),c.total=c.quantity*c.product_price,"function"==typeof b&&b(c)}function removeFromCard(a,b){var c=getItem(a);c.in_cart=!1,c.quantity=1,cartItems.splice(cartItems.indexOf(c),1);for(var d=[],e=menuCategories,f=0;f<e.length;f++)for(var g=0;g<e[f].items.length;g++){var h=e[f].items[g];h.in_cart&&d.push({product_id:h.product_id,quantity:h.quantity,options:h.opts?h.opts:{},note:h.note?h.note:""}),f==e.length-1&&g==e[f].items.length-1&&setTimeout(function(){$$.post(setting.base_url+"/order/cart",{data:d},function(a){})},100)}c.total=c.quantity*c.product_price,"function"==typeof b&&b(c)}function increaseItem(a,b){var c=getItem(a);c.quantity+=1,c.total=c.quantity*c.product_price,"function"==typeof b&&b(c)}function decreaseItem(a,b){var c=getItem(a);c.quantity>1&&(c.quantity-=1,c.total=c.quantity*c.product_price),"function"==typeof b&&b(c)}function resetCard(a,b){var c=getItem(a);c.opts={},c.note="";var d=$$('.card[data-id="'+a+'"]');d.find(".buttons-box,.options").addClass("hidden"),d.find(".addtoCart").removeClass("hidden"),d.find(".productQty").val("1"),d.find("textarea.order_note").val(""),d.find(".accordion-item").hasClass("accordion-item-expanded")&&app.accordionClose(d.find(".accordion-item")),d.find(".options-list li").each(function(a,b){$$(b).find("input").prop("checked",!1)}),"function"==typeof b&&b(c)}function addToYummy(a,b){var c=getItem(a),d="yummy-"+c.category_id+"-"+c.product_id;localStorage.setItem(d,"yes"),c.isYummy=!0,"function"==typeof b&&b(c)}function removeFromYummy(a,b){var c=getItem(a),d="yummy-"+c.category_id+"-"+c.product_id;localStorage.removeItem(d),c.isYummy=!1,yuumylist.items.splice(yuumylist.items.indexOf(c),1),"function"==typeof b&&b(c)}function isYummy(a,b){var c="yummy-"+a+"-"+b,d=localStorage.getItem(c);return"yes"==d?"active":""}function sendOrder(){app.showIndicator();for(var a=[],b=menuCategories,c=0;c<b.length;c++)for(var d=0;d<b[c].items.length;d++){var e=b[c].items[d];e.in_cart&&a.push({product_id:e.product_id,quantity:e.quantity,options:e.opts?e.opts:{},note:e.note?e.note:""}),c==b.length-1&&d==b[c].items.length-1&&setTimeout(function(){$$.post(setting.base_url+"/order/cart",{data:a},function(a){app.hideIndicator(),mainView.router.load({url:setting.cartPage,ignoreCache:!0}),app.closeModal(".popup")})},100)}}function categoriesList(a,b){var c=a;if(cartItems.length>0)for(var d=0;d<c.length;d++)for(var e=c[d].items,f=0;f<e.length;f++)for(var g=0;g<cartItems.length;g++)if(cartItems[g].product_id==e[f].product_id){var h=cartItems[g],i=e[f];i.in_cart=!0,i.note=h.note?h.note:"",i.quantity=parseInt(h.quantity),i.opts=h.options?h.options:{};for(var j=0;j<i.options.length;j++)if(h.options){var k=h.options[i.options[j].option_id];k&&(i.options[j].checked="true"===k)}}$$(".categories_list .card-link").on("click",function(){var a=$$(this).data("id"),b=$$(this).data("index"),d=!1;if("00"==a){yuumylist.category_name_ar=$$(this).find("span").text(),yuumylist.category_name_en=$$(this).find("span").text(),yuumylist.category_id=a;for(var e=0;e<localStorage.length;e++){var f=localStorage.key(e);if(f.indexOf("yummy")>=0){d=!0;var g=f.split("-");$$.each(c,function(a,b){b.category_id==g[1]&&$$.each(b.items,function(a,b){b.product_id==g[2]&&yuumylist.items.push(b)})})}}d||app.addNotification({custom:'<div class="note">'+lang.empty_yummy+"</div>"}),setTimeout(function(){if(yuumylist.items.length>0){var a=app.templates.categoryItems(yuumylist);app.popup(a),popUpopend(yuumylist)}},250)}else{for(var h=c[b].items,e=0;e<h.length;e++)for(var f=0;f<cartItems.length;f++)if(cartItems[f].product_id==h[e].product_id){var i=cartItems[f],j=h[e];j.in_cart=!0,j.note=i.note?i.note:"",j.quantity=parseInt(i.quantity),j.opts=i.opts?i.opts:{};for(var k=0;k<j.opts.length;k++)if(i.opts){var l=i.opts[j.opts[k].option_id];l&&(j.opts[k].checked="true"===l)}}var m=app.templates.categoryItems(c[b]);app.popup(m),popUpopend(c[b])}}),"function"==typeof b&&b(c)}function popUpopend(a){$$(".popup").on("opened",function(){$$(".shopCart .items_counter").text(cartItems.length)}),$$(".link.addtoCart").on("click",function(){var a=$$(this).parents(".item-card"),b=parseInt(a.data("id"));if(setting.loggedIn){$$(this).addClass("hidden");var c=a.find(".options");c.removeClass("hidden"),addToCard(b,function(a){incCounter(),$$('.card[data-id="'+a.product_id+'"]').find(".buttons-box").removeClass("hidden")})}else mainView.router.load({url:setting.site+"/member/login"}),setTimeout(function(){app.closeModal(".popup")},325)}),$$(".options").click(function(){var a=$$(this).parents(".item-card"),b=a.data("id");return app.accordionToggle('.card[data-id="'+b+'"] [data-item="'+b+'"]'),!1}),$$(".btn-remove").click(function(){var a=$$(this).parents(".item-card");removeFromCard(a.data("id"),function(a){resetCard(a.product_id),decCounter()})}),$$(".btn-plus").click(function(){var a=$$(this).parents(".item-card"),b=a.data("id");increaseItem(b,function(b){a.find(".productQty").val(b.quantity)})}),$$(".btn-minus").click(function(){var a=$$(this).parents(".item-card"),b=a.data("id");decreaseItem(b,function(b){a.find(".productQty").val(b.quantity)})}),$$(".order_note").on("change",function(){var a=$$(this).parents(".item-card"),b=a.data("id"),c=getItem(b);c.note=$$(this).val()}),$$('.label-switch input[type="checkbox"]').on("change",function(){var a=$$(this).data("itemid"),b=$$(this).data("id"),c=getItem(a);c.opts[b]=$$(this).prop("checked")}),$$(".add_to_yummy").click(function(){var a=$$(this).parents(".item-card"),b=a.data("id");$$(this).hasClass("active")?(removeFromYummy(b),$$(this).removeClass("active"),$$(this).parents(".popup ").hasClass("popup-items-00")&&($$(this).parents(".card").remove(),0==$$(".popup-items-00 .card").length&&app.closeModal(".popup-items-00"))):(addToYummy(b),$$(this).addClass("active"))}),$$(".popup .shopCart").click(function(){sendOrder()})}var app=new Framework7({init:!1,tapHold:!0,tapHoldDelay:250,material:!0,fastClicksDelayBetweenClicks:100,preloadPreviousPage:!0,materialRipple:!0,materialPageLoadDelay:100,cache:!1,uniqueHistory:!0,showBarsOnPageScrollTop:!0,showBarsOnPageScrollEnd:!0,template7Pages:!0,precompileTemplates:!0,dynamicPageUrl:"{{name}}",modalTitle:" ",sortable:!1,swipeout:!1,modalButtonOk:lang.ok,modalButtonCancel:lang.cancel,modalPreloaderTitle:lang.load,notificationCloseButtonText:lang.close,notificationCloseOnClick:!0,notificationHold:2e3,cacheIgnore:[setting.cartPage],scrollTopOnNavbarClick:!0,pushState:!1,onAjaxStart:function(a){app.showIndicator()},onAjaxComplete:function(a){app.hideIndicator()}}),api="http://www.shawermatac.com/mobapi/api/",$$=Dom7,quranData,mainView=app.addView(".view-main",{dynamicNavbar:!0,domCache:!1});$$(document).on("pageAfterAnimation",function(a){$$('a[target="_blank"]').each(function(a,b){$$(b).hasClass("external")||$$(b).addClass("external")});var b=a.detail.page;"index"!=b.name&&setTimeout(function(){$$(".page-on-center #link-back").removeClass("hidden")},150)});var branchLat,branchLong,branchTitle;app.onPageBeforeInit("contactus",function(){google.maps.event.addDomListener(window,"load",initialize)}),app.onPageInit("contactus",function(){google.maps.event.trigger(window,"load",initialize),$$("#contactFormm").on("submitted",function(a){a.detail.xhr,a.detail.data;$$("#contactFormm input , #contactFormm textarea").each(function(a,b){$$(b).val("")}),app.addNotification({message:lang.contact_message,button:{text:lang.close,color:"green"}})})}),app.onPageInit("branches",function(){$$(".readmore").on("click",function(){branchLat=$$(this).data("lat"),branchLong=$$(this).data("long"),branchTitle=$$(this).attr("title")})}),$$(document).on("pageInit",'.page[data-page^="branch-"]',function(a){initMap(branchTitle,branchLat,branchLong)}),app.onPageInit("bettcher",function(){app.swiper(".swiper-container",{autoplay:2500,speed:400,spaceBetween:50,slidesPerView:1,loop:!0})}),$$(document).on("keyup",".form-search ",function(a){13==a.keyCode&&$$(".form-search .button").click()}),$$(".form-search .button").on("click",function(a){var b=app.formToJSON(".form-search");b.keyword.length<3?$$(".notifications .notification-item").length||app.addNotification({message:lang.length_error,button:{text:lang.close,color:"yellow",close:!0}}):(app.closePanel(),$$.post(setting.site+"/search",b,function(a){"search_results"==mainView.activePage.name?mainView.router.reloadContent(a):mainView.router.loadContent(a),setTimeout(function(){$$(".form-search input").val("")},200)}))}),app.onPageInit("index",function(){app.swiper(".swiper-container",{autoplay:2500,speed:400,spaceBetween:0,autoHeight:!1,slidesPerView:3,loop:!0,breakpoints:{320:{slidesPerView:1,spaceBetweenSlides:10},480:{slidesPerView:1,spaceBetweenSlides:20},640:{slidesPerView:3,spaceBetweenSlides:30}}})}),app.onPageAfterAnimation("competition",function(){window.grecaptcha&&grecaptcha.render($$("#g-recaptcha")[0],{sitekey:$$("#g-recaptcha").attr("data-sitekey"),size:"compact"})}),app.onPageInit("login-page",function(){$$("#login_form").on("submitted",function(a){var b=(a.detail.xhr,JSON.parse(a.detail.data));b.flag?(mainView.router.back({url:setting.site,force:!0}),document.location.reload()):app.addNotification({custom:'<div class="note">'+b.msg+"</div>"})})}),$$(document).on("click",".btn-logout",function(){document.location.reload()}),app.onPageInit("forgot_password",function(){$$(".form-forgot_password").on("submitted",function(a){console.log(a);var b=a.detail.xhr,c=a.detail.data;console.log(b),console.log(c)})}),app.onPageAfterAnimation("register",function(){var a=$$('#signup-form input[name="user_name"]');0==a.val().length&&$$(".btn-submit").addClass("disabled"),a.on("change",function(){$$(".btn-submit").removeClass("disabled")})}),app.onPageInit("register",function(){$$(".btn-submit").click(function(){var a=app.formToJSON("#signup-form");$$.ajax({url:api+"member/signup?lang="+setting.lang,data:a,method:"POST",error:function(a,b){app.modal({title:"",afterText:JSON.parse(a.response).error,buttons:[{text:lang.close}]})},success:function(a,b,c){app.addNotification({message:lang.account_creation_successful,button:{text:lang.close,color:"yellow",close:!0}}),setTimeout(function(){document.location.reload()},1e3)}})})}),app.onPageInit("profile",function(){$$(".btn-update").click(function(){var a=app.formToJSON("#profile-form");$$.ajax({url:api+"member/profile?lang="+setting.lang,data:a,method:"POST",error:function(a,b){app.modal({title:"",afterText:JSON.parse(a.response).error,buttons:[{text:lang.close}]})},success:function(a,b,c){setTimeout(function(){mainView.router.refreshPage(),app.addNotification({message:lang.update_successful,button:{text:lang.close,color:"yellow",close:!0}})},100)}})})}),app.onPageInit("forgot_password",function(){$$(".btn-submit").click(function(){var a=app.formToJSON("#forgot_password-form");$$.ajax({url:api+"member/forgot_password?lang="+setting.lang,data:a,method:"POST",error:function(a,b){console.log(a),app.modal({title:"",afterText:JSON.parse(a.response).errors,buttons:[{text:lang.close}]})},success:function(a,b,c){app.addNotification({message:JSON.parse(a).message,button:{text:lang.close,color:"yellow",close:!0}})}})})});var menuCategories;$$.getMenu=function(a){$$.getJSON(api+"menu/menu?lang="+setting.lang,function(b){menuCategories=b,"function"==typeof a&&a(menuCategories)})},app.onPageInit("menu",function(a){$$.getMenu(function(b){$$.each(b,function(a,c){c.index=a;var d=app.templates.categories(c);$$(d).insertBefore(".ymy-box"),a==b.length-1&&$$(".ymy-box").removeClass("hidden")}),categoriesList(b,function(b){a.query.pro_id&&a.query.cate_id&&($$('.card-link[data-id="'+a.query.cate_id+'"]').trigger("click"),setTimeout(function(){var b=$$('.item-card[data-id="'+a.query.pro_id+'"]').offset().top-250;setTimeout(function(){$$(".popup .page-content").scrollTop(b,500)},200)},300))})})});var count=0|cartItems.length,yuumylist={};yuumylist.items=[],app.onPageInit("cart",function(){$$(".order_cancel").on("click",function(){$$.get(setting.site+"/order/cancel",{},function(a){cartItems=[],count=0,cart=[],orderDTO=[],mainView.router.back({url:setting.site+"/menu",force:!0})})}),$$("form.order-form").on("submitted",function(a){a.detail.xhr,a.detail.data;cartItems=[],count=0,cart=[],orderDTO=[],mainView.router.load({url:setting.site+"/order/orders"})})}),app.onPageAfterAnimation("orders",function(){setTimeout(function(){$$(".alert.alert-success").length>0&&app.modal({title:"",text:$$(".alert.alert-success").html(),buttons:[{text:setting.ok,bold:!0,onClick:function(){document.location.reload()}}]})},150)}),app.init();
