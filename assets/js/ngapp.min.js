function copy_object(a){return a.$$is_editing=!0,a.$$clone=angular.copy(a),a}function save_copy(a){return a.$$is_editing=!1,delete a.$$clone,a}function delete_copy(a){return a.$$is_editing=!1,angular.forEach(a.$$clone,function(b,c){c.startsWith("$$")||(a[c]=b)}),delete a.$$clone,a}function playSound(a,b){$(b).html('<audio autoplay="autoplay"><source src="'+a+'.mp3" type="audio/mpeg" /><source src="'+a+'.ogg" type="audio/ogg" /><embed hidden="true" autostart="true" loop="false" src="'+a+'.mp3" /></audio>')}!function(){angular.module("customField",[]).directive("customField",["$compile","$timeout",function(a,b){return{restrict:"AE",require:"ngModel",link:function(b,c,d,e){function f(d){var f=e.$viewValue;if(d&&f.field_attributes)try{var g=JSON.parse(f.field_attributes);$(c).html(""),"input"==f.field_type?(generateElem='<div class=""><input type="text" name="'+g.name+'" class="'+g.class+'" ng-model="Field.value" id="'+g.id+'"/></div>',c.html(generateElem),a(c.contents())(b)):"filepicker"==f.field_type?(generateElem='<div class="input-group"><input type="text" name="'+g.name+'" class="'+g.class+'" ng-model="Field.value" id="'+g.id+'"/><span class="input-group-btn"><a class="btn btn-primary" filemanager-btn="'+g.id+'"><i class="fa fa-key fa-fw"></i></a></span></div>',c.html(generateElem),a(c.contents())(b)):"editor"==f.field_type&&(generateElem='<textarea ng-model="Field.value" class="'+g.class+'" ui-tinymce name="'+g.name+'" id="'+f.name+'"></textarea>',c.html(generateElem),a(c.contents())(b))}catch(a){return}}b.$watch(function(){return e.$modelValue},f)}}}])}(),function(a,b){"use strict";var c=a.fn.val;a.fn.val=function(a){if(!arguments.length)return c.call(this);var d=c.call(this,a);return b.element(this[0]).triggerHandler("input"),d}}(window.jQuery,window.angular),function(){angular.module("filemanagerBtn",[]).directive("filemanagerBtn",["$timeout","$compile",function(a,b){return{restrict:"A",scope:{target_txtbx:"@filemanagerBtn"},link:function(a,b,c){$(b).attr("href",base_url+"assets/js/filemanager/dialog.php?type=2&field_id="+a.target_txtbx),$(b).fancybox({width:900,height:700,type:"iframe",autoScale:!1,afterClose:function(){var b=$("#"+a.target_txtbx);b.length>0&&angular.element(b[0]).triggerHandler("input")}})}}}])}(),function(){angular.module("knob",[]).directive("knob",function(){return{link:function(a,b,c){function d(){b.empty();var a=$('<input type="text" >'),d=c.min?parseInt(c.min):0,e=c.max?parseInt(c.max):0,f=c.value?parseInt(c.value):"",g="true"==c.readonly,h=c.sign?c.sign:"",i=c.color?c.color:"#00A65A",j=c.dangerLowerThen,k=c.warnLowerThen;j&&f<j?i="#F56954":k&&f<k&&(i="#F39C12"),b.append(a);var l={value:0,min:d,max:e>f?e:f,dynamicDraw:!0,width:60,height:60,fgColor:i,readOnly:g,rtl:"rtl"==c.dir,draw:function(){$(this.i).val(this.cv+h)}};a.knob(l),$(b).find("input").css("margin-left",0).css("margin-top",0).css("margin-top",0).css("left",0).css("top","24%").css("width","100%"),$(b).parent().css("position","relative"),a.animate({value:100},{duration:1e3,easing:"swing",progress:function(){$(this).val(Math.round(this.value/100*f)).trigger("change")}})}a.$watch(function(){return[c.value,c.max,c.min,c.readonly]},d,!0)}}})}(),function(){angular.module("autoActive",[]).directive("autoActive",["$location",function(a){return{restrict:"A",scope:!1,link:function(b,c){function d(){var b=a.path();b&&angular.forEach(c.find("li"),function(a){var c=a.querySelector("a");null!=c&&(c.href.match("#"+b+"(?=\\?|$)")?angular.element(a).addClass("active"):angular.element(a).removeClass("active"))})}d(),b.$on("$locationChangeSuccess",d)}}}])}(),function(){angular.module("ui.tinymce",[]).value("uiTinymceConfig",{}).directive("uiTinymce",["uiTinymceConfig",function(a){a=a||{};var b=0;return{require:"ngModel",link:function(c,d,e,f){console.log("tinymce created");var g,h,i,j="uiTinymce"+b++;e.id||e.$set("id",j),d.addClass(j),h={setup:function(a){a.on("init",function(a){f.$render()}),a.on("ExecCommand",function(b){a.save(),f.$setViewValue(d.val()),c.$$phase||c.$apply(),setTimeout(function(){$("#"+$(b.currentTarget).data("id")).change()})}),a.on("KeyUp",function(b){a.save(),f.$setViewValue(d.val()),c.$$phase||c.$apply(),setTimeout(function(){$("#"+$(b.currentTarget).data("id")).change()})})},relative_urls:!1,mode:"specific_textareas",editor_selector:j,height:200,theme:"modern",plugins:["advlist autolink link image lists charmap print preview hr anchor pagebreak","searchreplace wordcount visualblocks visualchars insertdatetime media nonbreaking","table contextmenu directionality emoticons paste textcolor code responsivefilemanager template"],toolbar1:"undo redo | bold italic underline | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | styleselect | visualblocks template",toolbar2:"| responsivefilemanager | link unlink anchor | image media | forecolor backcolor  | print preview code ",image_advtab:!0,visualblocks_default_state:!0,link_class_list:[{title:"None",value:""},{title:"link",value:"link"}],templates:[{title:"cultural council",description:"cultural council page layout",url:base_url+"assets/templates/council-page.html"},{title:"pricing policies",description:"pricing policies page layout",url:base_url+"assets/templates/pricing-policies.html"},{title:"artistic activities",description:"artistic activities page layout",url:base_url+"assets/templates/artistic-activities.html"},{title:"nursery school",description:"nursery school page layout",url:base_url+"assets/templates/nursery-school.html"},{title:"page fullwidth",description:"page fullwidth page layout",url:base_url+"assets/templates/page-fullwidth.html"},{title:"business leadership",description:"business leadership page layout",url:base_url+"assets/templates/business-leadership.html"}],external_filemanager_path:base_url+"assets/js/filemanager/",filemanager_title:"Filemanager",external_plugins:{filemanager:base_url+"assets/js/filemanager/plugin.min.js"}},g=e.uiTinymce?c.$eval(e.uiTinymce):{},angular.extend(h,a,g),tinymce.remove(),setTimeout(function(){tinymce.baseURL=base_url+"assets/js/tinymce/",tinymce.init(h),f.$render=function(){i||(i=tinymce.get(e.id)),i&&i.setContent(f.$viewValue||"")}})}}}])}(),function(){angular.module("spinner",[]).directive("spinner",function(){return{restrict:"A",link:function(a,b,c){$(b).spinner()}}})}(),function(){angular.module("modalFullscreen",[]).directive("modalFullscreen",function(){return{restrict:"AE",link:function(a,b,c){var d=$('<i class="fa fa-expand"></i>');b.append(d),b.addClass("modal-full-btn"),b.bind("click",function(){return b.parent().parent().parent().toggleClass("modal-full"),!1})}}})}(),function(){angular.module("switcher",[]).directive("switcher",function(){return{restrict:"A",link:function(a,b,c){new Switchery($(b)[0],{color:c.switcherColor?c.switcherColor:"#41b7f1"})}}})}(),function(){"use strict";angular.module("angularLoad",[]).service("angularLoad",["$document","$q","$timeout",function(a,b,c){function d(a){var d={};return function(e){if(void 0===d[e]){var f=b.defer(),g=a(e);g.onload=g.onreadystatechange=function(a){c(function(){f.resolve(a)})},g.onerror=function(a){c(function(){f.reject(a)})},d[e]=f.promise}return d[e]}}var e=a[0];this.loadScript=d(function(a){var b=e.createElement("script");return b.src=a,e.body.appendChild(b),b}),this.loadCSS=d(function(a){var b=e.createElement("link");return b.rel="stylesheet",b.type="text/css",b.href=a,e.head.appendChild(b),b})}])}(),angular.module("checkList",[]).directive("checkList",function(){return{scope:{list:"=checkList",value:"@"},link:function(a,b,c){var d=function(c){var d=b.prop("checked"),e=a.list.indexOf(a.value);d&&-1==e?c?b.prop("checked",!1):a.list.push(a.value):d||-1==e||(c?b.prop("checked",!0):a.list.splice(e,1))},e=d.bind(null,!0),f=d.bind(null,!1);b.bind("change",function(){a.$apply(f)}),a.$watch("list",e,!0)}}}),function(){angular.module("tree",[]).directive("treeItem",function(){return{restrict:"AE",link:function(a,b,c){b.addClass("treeItem")}}}).directive("tree",["$compile",function(a){return{restrict:"AE",scope:{list:"@",selectedItemChanged:"=",listItems:"=list",displayPropertyName:"@display",childPropertyName:"@child"},link:function(b,c,d){b.$watch("listItems",function(d,e){if(0!=d.length){c.html("");var f=$('<ul class="tree"><li class="treeItem" ng-repeat="child in listItems" ng-class="{hasItems : child[childPropertyName].length > 0}"><a href="#" >{{child[displayPropertyName]}}</a><tree list="child[childPropertyName]" selected-item-changed="selectedItemChanged" display="'+b.displayPropertyName+'" child="'+b.childPropertyName+'"></tree></li></ul>');c.append(f),a(c.contents())(b),$(c).bind("click","a",function(a){return!!$(a.target).parent("li").length&&("function"==typeof b.selectedItemChanged&&b.selectedItemChanged(angular.element(a.target).scope().child),$(a.target).parent("li").toggleClass("expand"),$("tree .active").removeClass("active"),$(a.target).parent("li").addClass("active"),!1)})}},!0)},controller:function(a){}}}])}();var modulesDef={},dasApp=angular.module("dasApp",["ngRoute","ui.grid","ui.grid.pagination","ui.grid.treeView","ui.grid.resizeColumns","ngSanitize","ui.grid.selection","ui.grid.exporter","ui.grid.pinning","ui.bootstrap","ui.tinymce","ui.select","filemanagerBtn","autoActive","knob","modalFullscreen","checkList","colorpicker.module","toaster","tree","ui.bootstrap.datetimepicker"]),lang="en";dasApp.apiBase=base_url+"index.php/api/",dasApp.baseUrl=base_url,dasApp.assetsUrl=base_url+"assets/",dasApp.constant("user",dasAppUser),dasApp.constant("modulesDef",modulesDef),dasApp.controller("MainController",["$scope","$route","$routeParams","$location","$http","entityManager","user","$timeout","$uibModal","$window","toaster",function(a,b,c,d,e,f,g,h,j,k,l){a.$route=b,a.$location=d,a.$routeParams=c,a.permissions=[],a.base_url=base_url,a.user=g,a.$root.base_url=base_url,a.messages=[],a.status_list=[{status_id:"0",status_name:"Pending"},{status_id:"1",status_name:"Ready"},{status_id:"2",status_name:"Delivered"},{status_id:"3",status_name:"Canceled"}],a.notifications={items:[],count:0};new f(dasApp.apiBase+"notifications/","notification_id",{data:"results"});a.getNotifications=function(){},a.modules=[],angular.forEach(modulesDef,function(b,c){("boolean"!=typeof b.enabled||b.enabled)&&(b.enabled=!0,a.modules.push(b))}),a.convertToDate=function(a,b){b&&console.log("converting",a);var c=a.split(" "),d=c[0].split("-"),e=c[1].split(":"),f=new Date(d[0],d[1]-1,d[2],e[0],e[1],e[2]);return b&&console.log("out",f),f};var m=a.convertToDate;a.removeNotification=function(b){a.notifications.items.indexOf(b)>=0&&e.post(dasApp.apiBase+"notifications/update_status/"+b.notification_id,{is_read:1})},a.viewOrder=function(b){e.get(dasApp.apiBase+"/orders?id="+b).then(function(b){var c=b.data;j.open({animation:a.animationsEnabled,templateUrl:dasApp.baseUrl+"assets/dashboard/views/orders/view.html",size:"lg",controller:["$scope",function(a){a.title="View Order",a.order=c,a.getTotal=function(a){return parseFloat(a.price)*parseFloat(a.quantity)},a.convertToDate=m,a.print=function(){w=window.open(),w.document.write("<html><head><title>Shawermatac :: شاورمتك</title>"),w.document.write('<link rel="stylesheet" href="'+dasApp.baseUrl+'assets/css/print.css?test" type="text/css" />'),w.document.write("</head><body >"),w.document.write(document.getElementsByClassName("order")[0].innerHTML+"<br/><h3>Order</h3>"+document.getElementsByClassName("details")[0].innerHTML),w.document.write("</body></html>"),h(function(){w.stop(),w.print(),w.close()},2e3)}}]}).result.then(function(a){},function(){})})},a.change_status=function(b,c){var d=(new f(dasApp.apiBase+"orders/","order_id",{data:"results"}),{});d.order_status=c,e.post(dasApp.apiBase+"orders/update_status/"+b,d).then(function(b){l.pop("info","","Status Changed Successfully"),a.getNotifications()},function(a){})};var n=new f(dasApp.apiBase+"contactus/","contactus_id",{data:"results"});a.getMessages=function(){n.search([{field:"contact_us.is_read",value:"0"}]).then(function(b){a.messages=b.results,h(a.getMessages,6e4)})},a.getMessages(),a.$on("onMessageRead",function(b,c){a.getMessages()}),a.getClass=function(){return d.path()===path?"active":""},prepPermissions=function(){return 0!=a.permissions.length||e.get(dasApp.apiBase+"/authorize/permission").then(function(b){a.permissions=b.data})},a.hasPermission=function(b,c){var d=!1;for(i=0;i<a.permissions.length;i++)a.permissions[i].permission_name==c&&a.permissions[i].permission_group==b&&(d=!0);return d}}]),dasApp.factory("myInterceptor",function(a,b){return{request:function(a){return a},requestError:function(c){return"UnAuthorized"==c.data.errors&&(b.location.href=dasApp.baseUrl+"dashboard"),a.reject(c)},response:function(a){return a},responseError:function(c){return"UnAuthorized"==c.data.errors&&(b.location.href=dasApp.baseUrl+"dashboard"),a.reject(c)}}}),dasApp.config(["$routeProvider","$locationProvider","user","$httpProvider","modulesDef",function(a,b,c,d,e){function f(b){b.sort||(b.sort=100),("boolean"!=typeof b.enabled||b.enabled)&&(b.enabled=!0,a.when(b.href,{templateUrl:base_url+"assets/dashboard/views/"+b.viewfolder+"/index.html",controller:"modelsController",resolve:{data:function(){return b}}}))}d.interceptors.push("myInterceptor"),angular.forEach(e,function(a,b){f(a)}),a.when("/",{templateUrl:base_url+"assets/dashboard/views/biography/index.html",controller:"biographyController",resolve:{isEdit:function(){return!1},prepPermissions:function(){return!0}}}),c.is_admin&&(a.when("/users",{templateUrl:base_url+"assets/dashboard/views/users/index.html",controller:"usersController",resolve:{isEdit:function(){return!1},prepPermissions:function(){return!0}}}),a.when("/biography",{templateUrl:base_url+"assets/dashboard/views/biography/index.html",controller:"biographyController",resolve:{isEdit:function(){return!1},prepPermissions:function(){return!0}}}),a.when("/users/:members",{templateUrl:base_url+"assets/dashboard/views/users/index.html",controller:"usersController",resolve:{isEdit:function(){return!1},prepPermissions:function(){return!0}}}),a.when("/groups",{templateUrl:base_url+"assets/dashboard/views/groups/index.html",controller:"groupsController",resolve:{isEdit:function(){return!1},prepPermissions:function(){return!0}}}),a.when("/broadcasts",{templateUrl:base_url+"assets/dashboard/views/broadcasts/index.html",controller:"broadcastsController"})),a.when("/branches",{templateUrl:base_url+"assets/dashboard/views/branches/index.html",controller:"branchesController",resolve:{isEdit:function(){return!1},prepPermissions:function(){return!0}}}),a.when("/sections",{templateUrl:base_url+"assets/dashboard/views/sections/index.html",controller:"sectionsController",resolve:{isEdit:function(){return!1},prepPermissions:function(){return!0}}}),a.when("/sections/:section_id",{templateUrl:base_url+"assets/dashboard/views/pages/index.html",controller:"pagesController",resolve:{isEdit:function(){return!1},prepPermissions:function(){return!0}}}),a.when("/pages",{templateUrl:base_url+"assets/dashboard/views/pages/index.html",controller:"pagesController",resolve:{isEdit:function(){return!1},prepPermissions:function(){return!0}}}),a.when("/sliders",{templateUrl:base_url+"assets/dashboard/views/sliders/index.html",controller:"slidersController",resolve:{isEdit:function(){return!1},prepPermissions:function(){return!0}}}),a.when("/menu",{templateUrl:base_url+"assets/dashboard/views/menu/index.html",controller:"menusController",resolve:{isEdit:function(){return!1},prepPermissions:function(){return!0}}}),a.when("/categories",{templateUrl:base_url+"assets/dashboard/views/categories/index.html",controller:"categoriesController",resolve:{isEdit:function(){return!1},prepPermissions:function(){return!0}}}),a.when("/products",{templateUrl:base_url+"assets/dashboard/views/products/index.html",controller:"productsController",resolve:{isEdit:function(){return!1},prepPermissions:function(){return!0}}}),a.when("/contactus",{templateUrl:base_url+"assets/dashboard/views/contactus/index.html",controller:"contactusController",resolve:{isEdit:function(){return!1},prepPermissions:function(){return!0}}}),a.when("/contactus/:feedback",{templateUrl:base_url+"assets/dashboard/views/contactus/index.html",controller:"contactusController",resolve:{isEdit:function(){return!1},prepPermissions:function(){return!0}}}),a.when("/newsletter-issues",{templateUrl:base_url+"assets/dashboard/views/newsletter_issues/index.html",controller:"newsletterIssuesController",resolve:{isEdit:function(){return!1},prepPermissions:function(){return!0}}}),a.when("/magazines",{templateUrl:base_url+"assets/dashboard/views/magazines/index.html",controller:"magazinesController",resolve:{isEdit:function(){return!1},prepPermissions:function(){return!0}}}),a.when("/press_release",{templateUrl:base_url+"assets/dashboard/views/press_release/index.html",controller:"pressReleaseController",resolve:{isEdit:function(){return!1},prepPermissions:function(){return!0}}}),a.when("/image_gallery",{templateUrl:base_url+"assets/dashboard/views/image_gallery/index.html",controller:"imageGalleryController",resolve:{isEdit:function(){return!1},prepPermissions:function(){return!0}}}),a.when("/video_gallery",{templateUrl:base_url+"assets/dashboard/views/video_gallery/index.html",controller:"videoGalleryController",resolve:{isEdit:function(){return!1},prepPermissions:function(){return!0}}}),a.when("/blog",{templateUrl:base_url+"assets/dashboard/views/blog/index.html",controller:"blogController",resolve:{isEdit:function(){return!1},prepPermissions:function(){return!0}}}),a.when("/newsletter-subscribes",{templateUrl:base_url+"assets/dashboard/views/newsletter_subscribes/index.html",controller:"NewsletterSubscribesController",resolve:{isEdit:function(){return!1},prepPermissions:function(){return!0}}}),a.when("/menu_items",{templateUrl:base_url+"assets/dashboard/views/menu_items/index.html",controller:"menuItemsController",resolve:{isEdit:function(){return!1},prepPermissions:function(){return!0}}}),a.otherwise({templateUrl:base_url+"assets/dashboard/views/biography/index.html",controller:"biographyController",resolve:{isEdit:function(){return!1},prepPermissions:function(){return!0}}})}]),dasApp.factory("entity",["$http",function(a){function b(a){a&&this.setData(a)}return b.prototype={setData:function(a){angular.extend(this,a)},isPublished:function(){return!0}},b}]),dasApp.factory("entityManager",["$http","$q","entity","$window","toaster",function(a,b,c,d,e){return function(f,g,h){var i={_pool:{},filters:[],options:{data:"results",count:"count",page:"page",perPage:"perPage"},_retrieveInstance:function(a,b){var d=this._pool[a];return d?d.setData(b):(d=new c(b),this._pool[a]=d),d},_search:function(a){return this._pool[a]},_load:function(b,c){var d=this;a.get(f+"?"+g+"="+b).success(function(a){var b=d._retrieveInstance(a[g],a);c.resolve(b)}).error(function(){c.reject()})},data:function(){return this._pool},search:function(a,b,c){var d=this;return this.clearFilters(),angular.forEach(a,function(a){d.addFilter(a.field,a.value,a.op)}),void 0==b&&(b=1),void 0==c&&(c=10),this.loadAll(b,c)},addFilter:function(a,b,c){this.filters.push({field:a,value:b,op:c||"eq"})},clearFilters:function(){this.filters=[]},getItem:function(a){var c=b.defer(),d=this._search(a);return d?c.resolve(d):this._load(a,c),c.promise},delete:function(b){return a.get(f+"delete/?id="+b).success(function(a){e.pop("error","","Item Deleted Successfully")})},add:function(c){var g=b.defer();return a.post(f,c).success(function(a){e.pop("success","","Item Added Successfully"),g.resolve(a)}).error(function(a){g.reject(a),"UnAuthorized"==a.errors&&(d.location.href=dasApp.baseUrl+"dashboard")}),g.promise},update:function(c,d){var g=b.defer();return a.post(f+"update/"+d,c).success(function(a){e.pop("info","","Item Updated Successfully"),g.resolve(a)}).error(function(a){g.reject(a)}),g.promise},loadAll:function(c,d){var e=b.defer(),h=this,i=f+"?";return void 0===c&&(c=1),i+="&page_number="+c,void 0===d&&(d=10),i+="&page_size="+d,this.filters.length>0&&(i+="&filter="+encodeURIComponent(JSON.stringify(this.filters))),a.get(i).success(function(a){var b=[];a[h.options.data]||(a[h.options.data]=a),a[h.options.data].forEach(function(a){var c=h._retrieveInstance(a[g],a);b.push(c)}),a[h.options.data]=b,e.resolve(a)}).error(function(a){e.reject(a)}),e.promise},setItem:function(a){var b=this,c=this._search(a[g]);return c?c.setData(a):c=b._retrieveInstance(a),c}};return h&&angular.forEach(h,function(a,b){void 0!==i.options[b]&&(i.options[b]=a)}),i}}]),dasApp.controller("NewsletterSubscribesController",["$scope","$http","entityManager","$uibModal",function(a,b,c,d){a.title="Newsletter Subscribes",a.isLoading={grid:!0},a.msg="",a.err=!1,a.gridOptions={useExternalPagination:!0,paginationPageSizes:[10,15,30],paginationPageSize:10,rowSelection:!0,columnDefs:[{width:120,field:"sender_email",name:"Sender Email"},{width:180,field:"contact_date",name:"Date"},{width:80,field:"is_read",displayName:"Status",cellTemplate:'<div class="ui-grid-cell-contents" title="TOOLTIP"><div  ng-if="row.entity.is_read == 0 " ><span class="label label-success">New</span></div></div>'},{width:110,pinnedRight:!0,name:"Actions",cellTemplate:'<div> &nbsp;<button class="btn btn-xs btn-primary" uib-tooltip="View Message" tooltip-placement="bottom" ng-click="grid.appScope.view(row.entity)"><i class="fa fa-eye"></i></button> <button class="btn btn-xs btn-danger" uib-tooltip="Delete Category" tooltip-placement="bottom" ng-click="grid.appScope.delete(row.entity)"><i class="fa fa-trash"></i></button></div>'}],data:[],onRegisterApi:function(b){b.pagination.on.paginationChanged(a,function(b,c){a.isLoading.grid=!0,e.loadAll(b,c).then(function(b){a.isLoading.grid=!1,a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total})})}},a.isLoading.grid=!0;var e=new c(dasApp.apiBase+"Newslettersubscribes/","newsletter_subscribe_id",{data:"results"});e.loadAll().then(function(b){a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total,a.isLoading.grid=!1}),a.refreshGrid=function(){a.isLoading.grid=!0,e.loadAll().then(function(b){a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total,a.isLoading.grid=!1})},a.view=function(c){if("1"!=c.is_edit){var e={};e.is_read="1",b.post(dasApp.apiBase+"Newslettersubscribes/update_status/"+c.newsletter_subscribe_id,e).then(function(b){c.is_read="1",a.$emit("onMessageRead",c.newsletter_subscribe_id)},function(a){})}d.open({animation:a.animationsEnabled,templateUrl:dasApp.baseUrl+"assets/dashboard/views/newsletter_subscribes/view.html",size:"lg",controller:["$scope",function(a){a.title=c.sender_email,a.message=c}]}).result.then(function(a){},function(){})},a.delete=function(b){a.message=b,a.modalInstance=d.open({animation:a.animationsEnabled,templateUrl:"DeleteDialog.html",scope:a})},a.confirm_delete=function(){message=a.message,e.delete(message.newsletter_subscribe_id).then(function(b){if(console.log(b.data.success),0==b.data.success)a.err=!0,a.msg=b.data.msg;else{var c=a.gridOptions.data.indexOf(message);a.gridOptions.data.splice(c,1),a.gridOptions.totalItems=a.gridOptions.totalItems-1,a.modalInstance.close()}},function(){})}}]),dasApp.controller("addBranchController",["$scope","entityManager","$uibModalInstance","branch","options","branchesManager",function(a,b,c,d,e,f){a.title=e.title,a.branch=d,a.isLoading={grid:!1},a.countries=[],new b(dasApp.apiBase+"branches/countries","country_id").loadAll().then(function(b){a.countries=b}),a.ok=function(){a.isLoading.grid=!0,1==e.isEdit?f.update(a.branch,a.branch.branch_id).then(function(b){a.isLoading.grid=!1,a.branch=save_copy(a.branch),c.close(b.data)},function(b){a.errors=b.errors,a.isLoading.grid=!1}):f.add(a.branch).then(function(b){a.isLoading.grid=!1,a.branch=save_copy(a.branch),c.close(b.data)},function(b){a.errors=b.errors,a.isLoading.grid=!1})},a.cancel=function(a){c.dismiss("cancel")},a.addBranch_image=function(){a.branch.branch_images||(a.branch.branch_images=[]),a.branch.branch_images.push({title_en:"",title_ar:"",description_en:"",description_ar:"",photo_en:"",photo_ar:"",sort:"",branch_id:0,$$is_editing:!0})},a.editBranch_image=function(a){a.$$is_editing=!0,a.$$clone=angular.copy(a)},a.saveBranch_image=function(a){a.$$is_editing=!1,delete a.$$clone},a.cancelBranch_image=function(a){a.$$is_editing=!1,angular.forEach(a.$$clone,function(b,c){c.startsWith("$$")||(a[c]=b)}),delete a.$$clone},a.removeBranch_image=function(b){var c=a.branch.branch_images.indexOf(b);c>=0&&a.branch.branch_images.splice(c,1)}}]),dasApp.controller("addCategoryController",["$scope","entityManager","$uibModalInstance","category","options","categoriesManager",function(a,b,c,d,e,f){a.title=e.title,a.category=d,a.isLoading={grid:!1},a.categories=[],f.loadAll(1,900).then(function(b){a.categories=b.results}),a.searchCategories=function(b){return f.search([{field:"categories.category_name_en",value:b,op:"like"},{field:"categories.category_name_ar",value:b,op:"orlike"}],1,1e3).then(function(b){a.categories=b.results})},a.ok=function(){a.isLoading.grid=!0,1==e.isEdit?f.update(a.category,a.category.category_id).then(function(b){a.isLoading.grid=!1,a.category=save_copy(a.category),c.close(b.data)},function(b){a.isLoading.grid=!1,a.errors=b.errors}):f.add(a.category).then(function(b){a.isLoading.grid=!1,a.category=save_copy(a.category),c.close(b.data)},function(b){a.errors=b.errors,a.isLoading.grid=!1})},a.cancel=function(a){c.dismiss("cancel")}}]),dasApp.controller("addGroupController",["$scope","entityManager","$uibModalInstance","group","options","groupRepo",function(a,b,c,d,e,f){a.title=e.title,a.group=d,a.isLoading={grid:!1},a.ok=function(){a.isLoading.grid=!0,1==e.isEdit?f.update(a.group,a.group.id).then(function(b){a.isLoading.grid=!1,a.group=save_copy(a.group),c.close(b.data)},function(b){a.errors=b.errors,a.isLoading.grid=!1}):f.add(a.group).then(function(b){a.isLoading.grid=!1,a.group=save_copy(a.group),c.close(b.data)},function(b){a.errors=b.errors,a.isLoading.grid=!1})},a.cancel=function(a){c.dismiss("cancel")}}]),dasApp.controller("addImageGalleryController",["$scope","entityManager","$uibModalInstance","model","options","modelManager",function(a,b,c,d,e,f){a.title=e.title,a.model=d,a.isLoading={grid:!1},a.addImage=function(){a.model.images||(a.model.images=[]),a.model.images.push({title_en:"",title_ar:"",description_en:"",description_ar:"",photo_en:"",photo_ar:"",sort:1,$$is_editing:!0})},a.editImage=function(a){a.$$is_editing=!0,a.$$clone=angular.copy(a)},a.saveImage=function(a){a.$$is_editing=!1,delete a.$$clone},a.cancelImage=function(a){a.$$is_editing=!1,angular.forEach(a.$$clone,function(b,c){c.startsWith("$$")||(a[c]=b)}),delete a.$$clone},a.removeImage=function(b){var c=a.model.images.indexOf(b);c>=0&&a.model.images.splice(c,1)},a.ok=function(){a.isLoading.grid=!0,1==e.isEdit?f.update(a.model,a.model.id).then(function(b){a.isLoading.grid=!1,a.model=save_copy(a.model),c.close(b.data)},function(b){a.errors=b.errors,a.isLoading.grid=!1}):f.add(a.model).then(function(b){a.isLoading.grid=!1,a.model=save_copy(a.model),c.close(b.data)},function(b){a.errors=b.errors,a.isLoading.grid=!1})},a.imageSortUp=function(b){var c=a.model.images.indexOf(b);if(0!=c){var d=a.model.images[c];a.model.images[c]=a.model.images[c-1],a.model.images[c-1]=d}},a.imageSortDown=function(b){var c=a.model.images.indexOf(b);if(c!=a.model.images.length-1){var d=a.model.images[c];a.model.images[c]=a.model.images[c+1],a.model.images[c+1]=d}},a.cancel=function(a){c.dismiss("cancel")}}]),dasApp.controller("addMenuController",["$scope","entityManager","$uibModalInstance","menu","options","menuManager",function(a,b,c,d,e,f){a.title=e.title,
a.allIcons=["fort-awesome lg valign-baseline","font-awesome","bars lg","caret-down","flag fw","wheelchair-alt fw","camera-retro fw","universal-access fw","hand-spock-o fw","ship fw","venus fw","file-image-o fw","spinner fw","check-square fw","credit-card fw","pie-chart fw","won fw","file-text-o fw","arrow-right fw","play-circle fw","facebook-official fw","medkit fw","universal-access","shopping-cart margin-right-sm hidden-sm hidden-md","flag","envelope","search","american-sign-language-interpreting","asl-interpreting","assistive-listening-systems","audio-description","blind","braille","deaf","deafness","envira","fa","first-order","gitlab","glide","glide-g","google-plus-circle","google-plus-official","hard-of-hearing","instagram","low-vision","pied-piper","question-circle-o","sign-language","signing","snapchat","snapchat-ghost","snapchat-square","themeisle","viadeo","viadeo-square","volume-control-phone","wheelchair-alt","wpbeginner","wpforms","yoast","adjust","anchor","archive","area-chart","arrows","arrows-h","arrows-v","asterisk","at","automobile","balance-scale","ban","bank","bar-chart","bar-chart-o","barcode","bars","battery-0","battery-1","battery-2","battery-3","battery-4","battery-empty","battery-full","battery-half","battery-quarter","battery-three-quarters","bed","beer","bell","bell-o","bell-slash","bell-slash-o","bicycle","binoculars","birthday-cake","bluetooth","bluetooth-b","bolt","bomb","book","bookmark","bookmark-o","briefcase","bug","building","building-o","bullhorn","bullseye","bus","cab","calculator","calendar","calendar-check-o","calendar-minus-o","calendar-o","calendar-plus-o","calendar-times-o","camera","camera-retro","car","caret-square-o-down","caret-square-o-left","caret-square-o-right","caret-square-o-up","cart-arrow-down","cart-plus","cc","certificate","check","check-circle","check-circle-o","check-square","check-square-o","child","circle","circle-o","circle-o-notch","circle-thin","clock-o","clone","close","cloud","cloud-download","cloud-upload","code","code-fork","coffee","cog","cogs","comment","comment-o","commenting","commenting-o","comments","comments-o","compass","copyright","creative-commons","credit-card","credit-card-alt","crop","crosshairs","cube","cubes","cutlery","dashboard","database","desktop","diamond","dot-circle-o","download","edit","ellipsis-h","ellipsis-v","envelope-o","envelope-square","eraser","exchange","exclamation","exclamation-circle","exclamation-triangle","external-link","external-link-square","eye","eye-slash","eyedropper","fax","feed","female","fighter-jet","file-archive-o","file-audio-o","file-code-o","file-excel-o","file-image-o","file-movie-o","file-pdf-o","file-photo-o","file-picture-o","file-powerpoint-o","file-sound-o","file-video-o","file-word-o","file-zip-o","film","filter","fire","fire-extinguisher","flag-checkered","flag-o","flash","flask","folder","folder-o","folder-open","folder-open-o","frown-o","futbol-o","gamepad","gavel","gear","gears","gift","glass","globe","graduation-cap","group","hand-grab-o","hand-lizard-o","hand-paper-o","hand-peace-o","hand-pointer-o","hand-rock-o","hand-scissors-o","hand-spock-o","hand-stop-o","hashtag","hdd-o","headphones","heart","heart-o","heartbeat","history","home","hotel","hourglass","hourglass-1","hourglass-2","hourglass-3","hourglass-end","hourglass-half","hourglass-o","hourglass-start","i-cursor","image","inbox","industry","info","info-circle","institution","key","keyboard-o","language","laptop","leaf","legal","lemon-o","level-down","level-up","life-bouy","life-buoy","life-ring","life-saver","lightbulb-o","line-chart","location-arrow","lock","magic","magnet","mail-forward","mail-reply","mail-reply-all","male","map","map-marker","map-o","map-pin","map-signs","meh-o","microphone","microphone-slash","minus","minus-circle","minus-square","minus-square-o","mobile","mobile-phone","money","moon-o","mortar-board","motorcycle","mouse-pointer","music","navicon","newspaper-o","object-group","object-ungroup","paint-brush","paper-plane","paper-plane-o","paw","pencil","pencil-square","pencil-square-o","percent","phone","phone-square","photo","picture-o","pie-chart","plane","plug","plus","plus-circle","plus-square","plus-square-o","power-off","print","puzzle-piece","qrcode","question","question-circle","quote-left","quote-right","random","recycle","refresh","registered","remove","reorder","reply","reply-all","retweet","road","rocket","rss","rss-square","search-minus","search-plus","send","send-o","server","share","share-alt","share-alt-square","share-square","share-square-o","shield","ship","shopping-bag","shopping-basket","shopping-cart","sign-in","sign-out","signal","sitemap","sliders","smile-o","soccer-ball-o","sort","sort-alpha-asc","sort-alpha-desc","sort-amount-asc","sort-amount-desc","sort-asc","sort-desc","sort-down","sort-numeric-asc","sort-numeric-desc","sort-up","space-shuttle","spinner","spoon","square","square-o","star","star-half","star-half-empty","star-half-full","star-half-o","star-o","sticky-note","sticky-note-o","street-view","suitcase","sun-o","support","tablet","tachometer","tag","tags","tasks","taxi","television","terminal","thumb-tack","thumbs-down","thumbs-o-down","thumbs-o-up","thumbs-up","ticket","times","times-circle","times-circle-o","tint","toggle-down","toggle-left","toggle-off","toggle-on","toggle-right","toggle-up","trademark","trash","trash-o","tree","trophy","truck","tty","tv","umbrella","university","unlock","unlock-alt","unsorted","upload","user","user-plus","user-secret","user-times","users","video-camera","volume-down","volume-off","volume-up","warning","wheelchair","wifi","wrench","hand-o-down","hand-o-left","hand-o-right","hand-o-up","ambulance","subway","train","genderless","intersex","mars","mars-double","mars-stroke","mars-stroke-h","mars-stroke-v","mercury","neuter","transgender","transgender-alt","venus","venus-double","venus-mars","file","file-o","file-text","file-text-o","info-circle lg li","cc-amex","cc-diners-club","cc-discover","cc-jcb","cc-mastercard","cc-paypal","cc-stripe","cc-visa","google-wallet","paypal","bitcoin","btc","cny","dollar","eur","euro","gbp","gg","gg-circle","ils","inr","jpy","krw","rmb","rouble","rub","ruble","rupee","shekel","sheqel","try","turkish-lira","usd","won","yen","align-center","align-justify","align-left","align-right","bold","chain","chain-broken","clipboard","columns","copy","cut","dedent","files-o","floppy-o","font","header","indent","italic","link","list","list-alt","list-ol","list-ul","outdent","paperclip","paragraph","paste","repeat","rotate-left","rotate-right","save","scissors","strikethrough","subscript","superscript","table","text-height","text-width","th","th-large","th-list","underline","undo","unlink","angle-double-down","angle-double-left","angle-double-right","angle-double-up","angle-down","angle-left","angle-right","angle-up","arrow-circle-down","arrow-circle-left","arrow-circle-o-down","arrow-circle-o-left","arrow-circle-o-right","arrow-circle-o-up","arrow-circle-right","arrow-circle-up","arrow-down","arrow-left","arrow-right","arrow-up","arrows-alt","caret-left","caret-right","caret-up","chevron-circle-down","chevron-circle-left","chevron-circle-right","chevron-circle-up","chevron-down","chevron-left","chevron-right","chevron-up","long-arrow-down","long-arrow-left","long-arrow-right","long-arrow-up","backward","compress","eject","expand","fast-backward","fast-forward","forward","pause","pause-circle","pause-circle-o","play","play-circle","play-circle-o","step-backward","step-forward","stop","stop-circle","stop-circle-o","youtube-play","500px","adn","amazon","android","angellist","apple","behance","behance-square","bitbucket","bitbucket-square","black-tie","buysellads","chrome","codepen","codiepie","connectdevelop","contao","css3","dashcube","delicious","deviantart","digg","dribbble","dropbox","drupal","edge","empire","expeditedssl","facebook","facebook-f","facebook-official","facebook-square","firefox","flickr","fonticons","fort-awesome","forumbee","foursquare","ge","get-pocket","git","git-square","github","github-alt","github-square","gittip","google","google-plus","google-plus-square","gratipay","hacker-news","houzz","html5","internet-explorer","ioxhost","joomla","jsfiddle","lastfm","lastfm-square","leanpub","linkedin","linkedin-square","linux","maxcdn","meanpath","medium","mixcloud","modx","odnoklassniki","odnoklassniki-square","opencart","openid","opera","optin-monster","pagelines","pied-piper-alt","pied-piper-pp","pinterest","pinterest-p","pinterest-square","product-hunt","qq","ra","rebel","reddit","reddit-alien","reddit-square","renren","resistance","safari","scribd","sellsy","shirtsinbulk","simplybuilt","skyatlas","skype","slack","slideshare","soundcloud","spotify","stack-exchange","stack-overflow","steam","steam-square","stumbleupon","stumbleupon-circle","tencent-weibo","trello","tripadvisor","tumblr","tumblr-square","twitch","twitter","twitter-square","usb","viacoin","vimeo","vimeo-square","vine","vk","wechat","weibo","weixin","whatsapp","wikipedia-w","windows","wordpress","xing","xing-square","y-combinator","y-combinator-square","yahoo","yc","yc-square","yelp","youtube","youtube-square","h-square","hospital-o","medkit","stethoscope","user-md"],a.icons=[],a.menu=d,a.isLoading={grid:!1},a.sections=[],a.pages=[],a.menus=[];var g=new b(dasApp.apiBase+"sections/","section_id",{data:"results"}),h=new b(dasApp.apiBase+"pages/","page_id",{data:"results"});new b(dasApp.apiBase+"menu/","menu_id",{data:"results"}).loadAll(1,100).then(function(b){a.menus=b.results}),g.loadAll(1,100).then(function(b){a.sections=b.results}),a.searchIcons=function(b){a.icons=$.grep(a.allIcons,function(a,c){return a.indexOf(b)>=0})},a.searchSections=function(b){return g.search([{field:"sections.section_title_en",value:b,op:"like"},{field:"sections.section_title_ar",value:b,op:"orlike"}]).then(function(b){a.sections=b.results})},1==e.isEdit&&h.loadAll(1,100).then(function(b){a.pages=b.results}),a.GetPages=function(b){return h.search([{field:"pages.section_id",value:b.section_id}]).then(function(b){a.pages=b.results})},a.searchPages=function(b,c){return h.search([{field:"pages.section_id",value:c},{field:"pages.page_title_en",value:b,op:"like"},{field:"pages.page_title_ar",value:b,op:"orlike"}]).then(function(b){a.pages=b.results})},a.addItem=function(){a.menu.menu_items||(a.menu.menu_items=[]),a.menu.menu_items.push({item_name_en:"",item_name_ar:"",link_type:"",link_value:"",item_sort:1,$$is_editing:!0})},a.editItem=function(a){a.$$is_editing=!0,a.$$clone=angular.copy(a)},a.saveItem=function(a){a.$$is_editing=!1,delete a.$$clone},a.cancelItem=function(a){a.$$is_editing=!1,angular.forEach(a.$$clone,function(b,c){c.startsWith("$$")||(a[c]=b)}),delete a.$$clone},a.removeItem=function(b){var c=a.menu.menu_items.indexOf(b);c>=0&&a.menu.menu_items.splice(c,1)},a.ok=function(){a.isLoading.grid=!0,1==e.isEdit?f.update(a.menu,a.menu.menu_id).then(function(b){a.isLoading.grid=!1,a.menu=save_copy(a.menu),c.close(b.data)},function(b){a.errors=b.errors,a.isLoading.grid=!1}):f.add(a.menu).then(function(b){a.isLoading.grid=!1,a.menu=save_copy(a.menu),c.close(b.data)},function(b){a.errors=b.errors,a.isLoading.grid=!1})},a.itemSortUp=function(b){var c=a.menu.menu_items.indexOf(b);if(0!=c){var d=a.menu.menu_items[c];a.menu.menu_items[c]=a.menu.menu_items[c-1],a.menu.menu_items[c-1]=d,b.item_sort=c-1}},a.itemSortDown=function(b){var c=a.menu.menu_items.indexOf(b);if(c!=a.menu.menu_items.length-1){var d=a.menu.menu_items[c];a.menu.menu_items[c]=a.menu.menu_items[c+1],a.menu.menu_items[c+1]=d,b.item_sort=c+1}},a.cancel=function(a){c.dismiss("cancel")},a.setSection=function(a,b){b.section_id=a.section_id}}]),dasApp.controller("addModelController",["$scope","$http","entityManager","$uibModalInstance","model","options","modelManager","data",function(a,b,c,d,e,f,g,h){a.title=f.title,a.model=e,a.data=h,a.isLoading={grid:!1},a.cancel=function(a){d.dismiss("cancel")},a.is_edit=f.isEdit,a.is_edit;var i={};a.entityslist={},angular.forEach(h.managers,function(b,d){i[b.name]=new c(dasApp.apiBase+b.name,b.id),a.entityslist[b.name]=[],b.filter?i[b.name].search(b.filter,1,900).then(function(c){a.entityslist[b.name]=c.results}):i[b.name].loadAll(1,900).then(function(c){a.entityslist[b.name]=c.results})}),a.searchManager=function(b,c){for(var d=[],e=0;e<c.searchfields.length;e++){var f=c.searchfields[e];d.push({field:f.field,value:b,op:f.op})}if(h.managers[c.managername].filter)for(var e=0;e<h.managers[c.managername].filter.length;e++){var f=h.managers[c.managername].filter[e];d.push(f)}return i[c.managername].search(d,1,1e3).then(function(b){a.entityslist[c.managername]=b.results})},a.getfieldsvalue=function(a,b){var c="";return a?(angular.forEach(b,function(b,d){c+=a[b]+" "}),c):""},a.formatDateTime=function(a){var b=a.getDate(),c=a.getMonth();c=parseInt(c)+1;var d=a.getFullYear(),e=a.getHours(),f=a.getMinutes();return b<10&&(b="0"+b),c<10&&(c="0"+c),e<10&&(e="0"+e),f<10&&(f="0"+f),d+"-"+c+"-"+b+" "+e+":"+f},a.onTimeSet=function(b,c,d){var e=a.formatDateTime(b);c[d]=e},a.ok=function(){a.isLoading.grid=!0,1==f.isEdit?g.update(a.model,a.model.id).then(function(b){a.isLoading.grid=!1,a.model=save_copy(a.model),d.close(b.data)},function(b){a.isLoading.grid=!1,a.errors=b.errors}):g.add(a.model).then(function(b){a.isLoading.grid=!1,a.model=save_copy(a.model),d.close(b.data)},function(b){a.errors=b.errors,a.isLoading.grid=!1})},a.addrowgrid=function(b){for(var c={},d=0;d<b.fields.length;d++){c[b.fields[d].field]=""}c[b.fk]=e[b.modelpk],c.$$is_editing=!0,a.model[b.field].push(c)},a.editrowgrid=function(a){a.$$is_editing=!0,a.$$clone=angular.copy(a)},a.saverowgrid=function(a){a.$$is_editing=!1,delete a.$$clone},a.cancelrowgrid=function(a){a.$$is_editing=!1,angular.forEach(a.$$clone,function(b,c){c.startsWith("$$")||(a[c]=b)}),delete a.$$clone},a.removerowgrid=function(b,c){var d=a.model[c.field].indexOf(b);d>=0&&a.model[c.field].splice(d,1)}}]),dasApp.controller("addPageController",["$scope","entityManager","$uibModalInstance","page","options","pagesManager","$timeout",function(a,b,c,d,e,f,g){a.title=e.title,a.section=e.section,a.page=d,a.isLoading={grid:!1},a.is_section=e.is_section,1==a.is_section&&(a.page.section_id=e.section_id),g(function(){$(".mce-tinymce").css({display:"block"})},1e3),a.sections=[];var h=new b(dasApp.apiBase+"sections/","section_id",{data:"results"});if(h.loadAll(1,100).then(function(b){a.sections=b.results}),a.layouts=[],new b(dasApp.apiBase+"pages/layouts","name").loadAll(1,100).then(function(b){a.layouts=b.results}),a.searchSections=function(b){return h.search([{field:"sections.section_title_en",value:b,op:"like"},{field:"sections.section_title_ar",value:b,op:"orlike"}]).then(function(b){a.sections=b.results})},a.formatDateTime=function(a){var b=a.getDate(),c=a.getMonth();c=parseInt(c)+1;var d=a.getFullYear(),e=a.getHours(),f=a.getMinutes();return b<10&&(b="0"+b),c<10&&(c="0"+c),e<10&&(e="0"+e),f<10&&(f="0"+f),d+"-"+c+"-"+b+" "+e+":"+f},a.onTimeSet=function(b,c){var d=a.formatDateTime(b);a.page.date=d},1==e.isEdit)"0000-00-00 00:00:00"==a.page.date?(a.page.date=new Date(a.page.created_date),a.page.date=a.formatDateTime(a.page.date)):(a.page.date=new Date(a.page.date),a.page.date=a.formatDateTime(a.page.date));else{var i=new Date;a.page.date=a.formatDateTime(i)}a.ok=function(){a.isLoading.grid=!0,1==e.isEdit?f.update(a.page,a.page.page_id).then(function(b){a.isLoading.grid=!1,a.page=save_copy(a.page),c.close(b.data)},function(b){a.errors=b.errors,a.isLoading.grid=!1}):f.add(a.page).then(function(b){a.page=save_copy(a.page),a.isLoading.grid=!1,c.close(b.data)},function(b){a.errors=b.errors,a.isLoading.grid=!1})},a.cancel=function(a){c.dismiss("cancel")},a.init_values=function(b){a.page.custom_fields=b.custom_fields,a.page.custom_field_values=[],angular.forEach(b.custom_fields,function(b,c){a.page.custom_field_values.push({custom_field_id:b.id,value:""})})};var j=0;angular.forEach(a.page.custom_fields,function(b,c){delete b.value,void 0==a.page.custom_field_values[j]&&(a.page.custom_field_values[j]={custom_field_id:b.id}),j++})}]),dasApp.controller("addProductController",["$scope","entityManager","$uibModalInstance","product","options","productsManager",function(a,b,c,d,e,f){a.title=e.title,a.product=d,a.isLoading={grid:!1},a.categories=[];var g=new b(dasApp.apiBase+"categories","category_id");g.loadAll(1,900).then(function(b){a.categories=b.results}),a.searchCategories=function(b){return g.search([{field:"categories.category_name_en",value:b,op:"like"},{field:"categories.category_name_ar",value:b,op:"orlike"}],1,1e3).then(function(b){a.categories=b.results})},a.ok=function(){a.isLoading.grid=!0,1==e.isEdit?f.update(a.product,a.product.product_id).then(function(b){a.isLoading.grid=!1,a.product=save_copy(a.product),c.close(b.data)},function(b){a.isLoading.grid=!1,a.errors=b.errors}):f.add(a.product).then(function(b){a.isLoading.grid=!1,a.product=save_copy(a.product),c.close(b.data)},function(b){a.errors=b.errors,a.isLoading.grid=!1})},a.cancel=function(a){c.dismiss("cancel")},a.clear_image=function(){a.product.ad_image="",$("#ad_prev").attr("src","http://localhost/Shawermatac-New/src/uploads/nophoto.jpg")},a.addProduct_image=function(){a.product.product_images||(a.product.product_images=[]),a.product.product_images.push({title_en:"",title_ar:"",description_en:"",description_ar:"",photo_en:"",photo_ar:"",sort:"",product_id:0,$$is_editing:!0})},a.editProduct_image=function(a){a.$$is_editing=!0,a.$$clone=angular.copy(a)},a.saveProduct_image=function(a){a.$$is_editing=!1,delete a.$$clone},a.cancelProduct_image=function(a){a.$$is_editing=!1,angular.forEach(a.$$clone,function(b,c){c.startsWith("$$")||(a[c]=b)}),delete a.$$clone},a.removeProduct_image=function(b){var c=a.product.product_images.indexOf(b);c>=0&&a.product.product_images.splice(c,1)}}]),dasApp.controller("addSectionController",["$scope","entityManager","$uibModalInstance","section","options","sectionsManager",function(a,b,c,d,e,f){a.title=e.title,a.section=d,f.loadAll(1,1e3).then(function(b){a.sections=b.results}),a.isLoading={grid:!1},a.layouts=[],new b(dasApp.apiBase+"sections/layouts","name").loadAll(1,100).then(function(b){a.layouts=b.results}),a.ok=function(){a.isLoading.grid=!0,1==e.isEdit?f.update(a.section,a.section.section_id).then(function(b){a.isLoading.grid=!1,a.section=save_copy(a.section),c.close(b.data)},function(b){a.isLoading.grid=!1,a.errors=b.errors}):f.add(a.section).then(function(b){a.isLoading.grid=!1,a.section=save_copy(a.section),c.close(b.data)},function(b){a.isLoading.grid=!1,a.errors=b.errors})},a.cancel=function(a){c.dismiss("cancel")},a.addcustom_field=function(){a.section.custom_fields.push({id:"",label_en:"",label_ar:"",type:"",is_required:"",$$is_editing:!0})},a.editcustom_field=function(a){a.$$is_editing=!0,a.$$clone=angular.copy(a)},a.savecustom_field=function(a){a.$$is_editing=!1,delete a.$$clone},a.cancelcustom_field=function(a){a.$$is_editing=!1,angular.forEach(a.$$clone,function(b,c){c.startsWith("$$")||(a[c]=b)}),delete a.$$clone},a.removecustom_field=function(b){var c=a.section.custom_fields.indexOf(b);c>=0&&a.section.custom_fields.splice(c,1)}}]),dasApp.controller("addSliderController",["$scope","entityManager","$uibModalInstance","slider","options","slidersManager",function(a,b,c,d,e,f){a.title=e.title,a.slider=d,a.isLoading={grid:!1},a.addSlide=function(){a.slider.slides||(a.slider.slides=[]),a.slider.slides.push({slide_title_en:"",slide_title_ar:"",slide_description_en:"",slide_description_ar:"",slide_photo_en:"",slide_photo_ar:"",slide_sort:1,$$is_editing:!0})},a.editSlide=function(a){a.$$is_editing=!0,a.$$clone=angular.copy(a)},a.saveSlide=function(a){a.$$is_editing=!1,delete a.$$clone},a.cancelSlide=function(a){a.$$is_editing=!1,angular.forEach(a.$$clone,function(b,c){c.startsWith("$$")||(a[c]=b)}),delete a.$$clone},a.removeSlide=function(b){var c=a.slider.slides.indexOf(b);c>=0&&a.slider.slides.splice(c,1)},a.ok=function(){a.isLoading.grid=!0,1==e.isEdit?f.update(a.slider,a.slider.slider_id).then(function(b){a.isLoading.grid=!1,a.slider=save_copy(a.slider),c.close(b.data)},function(b){a.errors=b.errors,a.isLoading.grid=!1}):f.add(a.slider).then(function(b){a.isLoading.grid=!1,a.slider=save_copy(a.slider),c.close(b.data)},function(b){a.errors=b.errors,a.isLoading.grid=!1})},a.slideSortUp=function(b){var c=a.slider.slides.indexOf(b);if(0!=c){var d=a.slider.slides[c];a.slider.slides[c]=a.slider.slides[c-1],a.slider.slides[c-1]=d}},a.slideSortDown=function(b){var c=a.slider.slides.indexOf(b);if(c!=a.slider.slides.length-1){var d=a.slider.slides[c];a.slider.slides[c]=a.slider.slides[c+1],a.slider.slides[c+1]=d}},a.cancel=function(a){c.dismiss("cancel")}}]),dasApp.controller("addUserController",["$scope","entityManager","$uibModalInstance","user","options","userRepo",function(a,b,c,d,e,f){a.title=e.title,a.user=d,a.is_member=e.is_member,a.isLoading={grid:!1},a.groups={},new b(dasApp.apiBase+"groups","id").loadAll().then(function(b){a.groups=b.results}),a.branches={},new b(dasApp.apiBase+"branches","branch_id").loadAll(1,100).then(function(b){a.branches=b.results}),1==a.is_member&&(a.user.group="4"),a.ok=function(){a.isLoading.grid=!0,1==e.isEdit?f.update(a.user,a.user.id).then(function(b){a.isLoading.grid=!1,a.user=save_copy(a.user),c.close(b.data)},function(b){a.errors=b.errors,a.isLoading.grid=!1}):f.add(a.user).then(function(b){a.isLoading.grid=!1,a.user=save_copy(a.user),c.close(b.data)},function(b){a.errors=b.errors,a.isLoading.grid=!1})},a.cancel=function(a){c.dismiss("cancel")}}]),dasApp.controller("assignGroupController",["$scope","entityManager","$uibModalInstance","user","options","userRepo","$http",function(a,b,c,d,e,f,g){a.title=e.title,a.user=d,a.isLoading={grid:!1},a.user_groups={},new b(dasApp.apiBase+"groups","id").loadAll().then(function(b){a.user_groups=b.results}),a.branches={},new b(dasApp.apiBase+"branches","branch_id").loadAll(1,100).then(function(b){a.branches=b.results}),a.ok=function(){a.isLoading.grid=!0,a.user.selected=d.group_id,g.post(dasApp.apiBase+"users/assign_group",a.user).then(function(b){a.isLoading.grid=!1,c.close(b.data)},function(b){a.errors=b.errors,a.isLoading.grid=!1}),a.update_user={},a.update_user.branch_id=d.branch_id,a.update_user.username=d.username,a.update_user.password=d.password,a.update_user.first_name=d.first_name,a.update_user.email=d.email,a.update_user.group_id=d.group_id,f.update(a.update_user,a.user.id).then(function(a){c.close(a.data)},function(b){a.errors=b.errors})},a.cancel=function(){c.dismiss("cancel")}}]),dasApp.controller("biographyController",["$scope","$http","$uibModal","$timeout",function(a,b,c,d){function e(){a.isLoading.grid=!0,b.get(dasApp.apiBase+"biography").success(function(b){a.biography=b,a.isLoading.grid=!1})}a.title="Biography",a.msg="",a.err=!1,a.biography=[],a.done="",a.showMsg=!1,a.isLoading={grid:!0},e(),a.ok=function(){a.isLoading.grid=!0,b.post(dasApp.apiBase+"biography",a.biography).then(function(b){a.isLoading.grid=!1,a.showMsg=!0,a.done="Updated Successfully",d(function(){a.showMsg=!1},6e3)})},a.cancel=function(){e()}}]),dasApp.controller("branchesController",["$scope","$http","entityManager","$uibModal",function(a,b,c,d){a.title="Branches",a.isLoading={grid:!0},a.msg="",a.err=!1,a.force=!1,a.gridOptions={useExternalPagination:!0,paginationPageSizes:[10,15,30],paginationPageSize:10,rowSelection:!0,columnDefs:[{width:70,field:"branch_code",displayName:"Code"},{width:120,field:"branch_name_en",displayName:"Name En"},{width:120,field:"branch_name_ar",displayName:"Name Ar"},{minWidth:180,field:"branch_address_en",displayName:"Address En"},{minWidth:180,field:"branch_address_ar",displayName:"Address Ar"},{width:120,field:"branch_phone",displayName:"Phone"},{width:120,field:"branch_mobile",displayName:"Mobile"},{width:120,field:"country_name_en",displayName:"Country"},{width:120,pinnedRight:!0,name:"Actions",cellTemplate:'<div><button class="btn btn-xs btn-success" uib-tooltip="Edit Branch" tooltip-placement="right" ng-click="grid.appScope.edit(row.entity)"><i class="fa fa-pencil"></i></button> <button class="btn btn-xs btn-danger" uib-tooltip="Delete Branch" tooltip-placement="bottom" ng-click="grid.appScope.delete(row.entity)"><i class="fa fa-trash"></i></button></div>'}],data:[],onRegisterApi:function(b){b.pagination.on.paginationChanged(a,function(b,c){a.isLoading.grid=!0,e.loadAll(b,c).then(function(b){a.isLoading.grid=!1,a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total})})}},a.isLoading.grid=!0;var e=new c(dasApp.apiBase+"branches/","branch_id",{data:"results"});e.loadAll().then(function(b){a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total,a.isLoading.grid=!1}),a.edit=function(b){b=copy_object(b),a.add(!0,b)},a.add=function(b,c){a.branch=c,d.open({animation:a.animationsEnabled,templateUrl:dasApp.baseUrl+"assets/dashboard/views/branches/form.html",controller:"addBranchController",size:"lg",resolve:{options:{title:(b?"Edit":"Add")+" Branch",isEdit:!!b},branchesManager:e,branch:b?c:{branch_images:[]}}}).result.then(function(c){b||a.gridOptions.data.push(c)},function(){})},a.delete=function(b){a.branch=b,a.modalInstance=d.open({animation:a.animationsEnabled,templateUrl:"DeleteDialog.html",scope:a})},a.confirm_delete=function(){branch=a.branch,e.delete(branch.branch_id).then(function(b){var c=a.gridOptions.data.indexOf(branch);a.gridOptions.data.splice(c,1),a.gridOptions.totalItems=a.gridOptions.totalItems-1,a.force=!1,a.modalInstance.close()},function(a){"UnAuthorized"==a.errors&&($window.location.href=dasApp.baseUrl+"dashboard")})},a.cancel=function(){a.modalInstance.dismiss("cancel")},a.refresh=function(){products.loadAll().then(function(b){a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total})}}]),dasApp.controller("categoriesController",["$scope","$http","entityManager","$uibModal",function(a,b,c,d){a.title="Categories",a.isLoading={grid:!0},a.msg="",a.err=!1,a.gridOptions={useExternalPagination:!0,paginationPageSizes:[10,15,30],paginationPageSize:10,rowSelection:!0,columnDefs:[{field:"category_name_en",name:"Name En"},{field:"category_name_ar",name:"Name Ar"},{field:"category_description_en",name:"Description En"},{field:"category_description_ar",name:"Description Ar"},{pinnedRight:!0,name:"Actions",cellTemplate:'<div><button class="btn btn-xs btn-success" uib-tooltip="Edit Category" tooltip-placement="right" ng-click="grid.appScope.edit(row.entity)"><i class="fa fa-pencil"></i></button> <button class="btn btn-xs btn-danger" uib-tooltip="Delete Category" tooltip-placement="bottom" ng-click="grid.appScope.delete(row.entity)"><i class="fa fa-trash"></i></button></div>'}],data:[],onRegisterApi:function(b){b.pagination.on.paginationChanged(a,function(b,c){a.isLoading.grid=!0,e.loadAll(b,c).then(function(b){a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total,a.isLoading.grid=!1})})}},a.isLoading.grid=!0;var e=new c(dasApp.apiBase+"categories/","category_id",{data:"results"});e.loadAll().then(function(b){a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total,a.isLoading.grid=!1}),a.edit=function(b){b=copy_object(b),a.add(!0,b)},a.add=function(b,c){a.category=c,d.open({animation:a.animationsEnabled,templateUrl:dasApp.baseUrl+"assets/dashboard/views/categories/form.html",controller:"addCategoryController",size:"lg",resolve:{options:{title:(b?"Edit":"Add")+"Category",isEdit:!!b},categoriesManager:e,category:b?c:{}}}).result.then(function(c){b||a.gridOptions.data.push(c)},function(){delete_copy(a.category)})},a.delete=function(b){a.category=b,a.modalInstance=d.open({animation:a.animationsEnabled,templateUrl:"DeleteDialog.html",scope:a})},a.confirm_delete=function(){category=a.category,e.delete(category.category_id).then(function(b){if(console.log(b.data.success),0==b.data.success)a.err=!0,a.msg=b.data.msg;else{var c=a.gridOptions.data.indexOf(category);a.gridOptions.data.splice(c,1),a.gridOptions.totalItems=a.gridOptions.totalItems-1,a.modalInstance.close()}},function(){})},a.cancel=function(){a.modalInstance.dismiss("cancel")},a.refresh=function(){products.loadAll().then(function(b){a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total})}}]),dasApp.controller("contactusController",["$scope","$http","entityManager","$uibModal","$routeParams",function(a,b,c,d,e){a.title="Contact Us";var f=e.feedback;a.is_feedback=!1,void 0!==f&&(a.is_feedback=!0,a.title="Feedback");var g=new c(dasApp.apiBase+"contactus/","contactus_id",{data:"results"});if(a.isLoading={grid:!0},a.msg="",a.err=!1,a.gridOptions={useExternalPagination:!0,paginationPageSizes:[10,15,30],paginationPageSize:10,rowSelection:!0,columnDefs:[{minWidth:120,field:"title",name:"Title"},{width:120,field:"sender_name",name:"Sender Name"},{width:120,field:"sender_phone",name:"Sender Phone"},{width:120,field:"sender_email",name:"Sender Email"},{width:180,field:"contact_date",name:"Date"},{width:80,field:"is_read",displayName:"Status",cellTemplate:'<div class="ui-grid-cell-contents" title="TOOLTIP"><div  ng-if="row.entity.is_read == 0 " ><span class="label label-success">New</span></div></div>'},{width:110,pinnedRight:!0,name:"Actions",cellTemplate:'<div> &nbsp;<button class="btn btn-xs btn-primary" uib-tooltip="View Message" tooltip-placement="bottom" ng-click="grid.appScope.view(row.entity)"><i class="fa fa-eye"></i></button> <button class="btn btn-xs btn-danger" uib-tooltip="Delete" tooltip-placement="bottom" ng-click="grid.appScope.delete(row.entity)"><i class="fa fa-trash"></i></button></div>'}],data:[],onRegisterApi:function(b){b.pagination.on.paginationChanged(a,function(b,c){if(a.isLoading.grid=!0,1==a.is_feedback){var d=[];d.push({field:"contact_us.type",value:"1"})}else{var d=[];d.push({field:"contact_us.type",value:"0"})}g.search(d,b,c).then(function(b){a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total,a.isLoading.grid=!1})})}},a.isLoading.grid=!0,1==a.is_feedback){var h=[];h.push({field:"contact_us.type",value:"1"})}else{var h=[];h.push({field:"contact_us.type",value:"0"})}g.search(h).then(function(b){a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total,a.isLoading.grid=!1}),a.refreshGrid=function(){a.isLoading.grid=!0,g.loadAll().then(function(b){a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total,a.isLoading.grid=!1})},a.view=function(c){if("1"!=c.is_edit){var e={};e.is_read="1",b.post(dasApp.apiBase+"contactus/update_status/"+c.contactus_id,e).then(function(b){c.is_read="1",a.$emit("onMessageRead",c.contactus_id)},function(a){})}d.open({animation:a.animationsEnabled,templateUrl:dasApp.baseUrl+"assets/dashboard/views/contactus/view.html",size:"lg",controller:["$scope",function(a){a.title=c.title,a.message=c}]}).result.then(function(a){},function(){})},a.delete=function(b){a.message=b,a.modalInstance=d.open({animation:a.animationsEnabled,templateUrl:"DeleteDialog.html",scope:a})},a.confirm_delete=function(){message=a.message,g.delete(message.contactus_id).then(function(b){if(0==b.data.success)a.err=!0,a.msg=b.data.msg;else{var c=a.gridOptions.data.indexOf(message);a.gridOptions.data.splice(c,1),a.gridOptions.totalItems=a.gridOptions.totalItems-1,a.modalInstance.close()}},function(){})}}]),dasApp.controller("dashboardController",["$scope","$http","entityManager","$timeout",function(a,b,c,d){function e(a,b){var c=b-a.toString().length+1;return Array(+(c>0&&c)).join("0")+a}function f(b,c,e){function f(){new Morris.Donut({element:"sales-chart",resize:!0,colors:["#D8354A","#FFFF00","#3c8dbc","#00A65A","#f56954","#00a65a"],data:c,hideHover:"auto"})}new Morris.Area({element:"revenue-chart",resize:!0,data:b,xkey:"y",ykeys:["item1"],labels:["Item 1"],lineColors:["#a0d0e0"],hideHover:"auto"}),new Morris.Line({element:"line-chart",resize:!0,data:e,xkey:"y",xLabels:["hour"],postUnits:["SR"],ykeys:["Sales"],labels:["Sales"],lineColors:["#efefef"],lineWidth:2,hideHover:"auto",gridTextColor:"#fff",gridStrokeWidth:.4,pointSize:4,pointStrokeColors:["#efefef"],gridLineColor:"#efefef",gridTextFamily:"Open Sans",gridTextSize:10})
;a.redrawDonut=function(){d(f,1e3)}}a.title="dashboard",a.todos=[],a.isLoading={lastOrders:!0,stats:!0},a.stats={top_products:[],today_orders_count:0,today_orders_total:0,orders_per_branch:[],monthly_sales:[],products_count:0,members_count:1};var g={0:"pending",1:"ready",2:"delivered",3:"canceled"};a.statusClass={0:"warning",1:"primary",2:"success",3:"danger"},a.order_stats=g;var h=new c(dasApp.apiBase+"/todos/","todo_id");h.loadAll().then(function(b){a.todos=b.results},function(){}),a.addTodo=function(){a.todos.push({is_done:"no",$$isEdit:!0,created_date:new Date})},a.saveTodo=function(b){b.todo_id?h.update(b,b.todo_id).then(function(){b.$$isEdit=!1,a.todoErros="",a.todoHasErros=!1},function(b){a.todoErros=b.errors,a.todoHasErros=!0}):h.add(b).then(function(){b.$$isEdit=!1,a.todoErros="",a.todoHasErros=!1},function(b){a.todoErros=b.errors,a.todoHasErros=!0})},a.editTodo=function(a){a.$$isEdit=!0},a.deleteTodo=function(b){function c(b){var c=a.todos.indexOf(b);c>=0&&a.todos.splice(c,1)}b.todo_id?h.delete(b.todo_id).then(function(){c(b)},function(){c(b)}):c(b)},a.latestOrders=[],a.refreshLastOrders=function(){a.isLoading.lastOrders=!0,new c(dasApp.apiBase+"orders/","order_id",{data:"results"}).loadAll(1,10).then(function(b){a.latestOrders=b.results,a.isLoading.lastOrders=!1})},a.refreshLastOrders(),a.isLoading.stats=!0,b.get(dasApp.apiBase+"/dashboard/stats").then(function(b){a.stats=b.data;for(var c=[],d=[],h=[],i=(new Date).getFullYear(),j=0;j<a.stats.monthly_sales.length;j++){var k=a.stats.monthly_sales[j];c.push({y:i+"-"+parseInt(k.month),item1:k.sum})}for(var l=0;l<a.stats.orders_per_branch.length;l++){var k=a.stats.orders_per_branch[l];d.push({label:k.branch_name_en,value:k.orders_count})}for(var m=0;m<a.stats.hourly_sales.length;m++){var k=a.stats.hourly_sales[m];h.push({y:k.tt+" "+e(parseInt(k.hour),2)+":00",Sales:k.sum})}var n={};angular.forEach(a.stats.orders_count_per_status,function(a,b){n[g[a.order_status]]=a.orders_count}),a.stats.orders_count_per_status=n,f(c,d,h),a.isLoading.stats=!1},function(a){"UnAuthorized"==a.errors&&($window.location.href=dasApp.baseUrl+"dashboard")})}]),dasApp.controller("groupsController",["$scope","$http","entityManager","$uibModal",function(a,b,c,d){a.title="Groups",a.isLoading={grid:!0},a.gridOptions={paginationPageSizes:[10,15,30],paginationPageSize:10,enableRowSelection:!0,enableRowHeaderSelection:!1,multiSelect:!1,columnDefs:[{minWidth:100,field:"name",displayName:"Name"},{minWidth:120,field:"description",displayName:"Description"},{width:120,pinnedRight:!0,name:"Actions",cellTemplate:'<div> <button class="btn btn-xs btn-success" tooltip-placement="right" uib-tooltip="Edit Group" ng-click="grid.appScope.edit(row.entity)"><i class="fa fa-pencil"></i></button> <button class="btn btn-xs btn-danger" uib-tooltip="Delete Group" tooltip-placement="bottom" ng-click="grid.appScope.delete(row.entity)"><i class="fa fa-trash"></i></button> </div>'}],data:[],onRegisterApi:function(b){b.pagination.on.paginationChanged(a,function(b,c){a.isLoading.grid=!0,e.loadAll().then(function(b){a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total,a.isLoading.grid=!1})})}},a.isLoading.grid=!0;var e=new c(dasApp.apiBase+"groups/","id",{data:"results"});e.loadAll().then(function(b){a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total,a.isLoading.grid=!1}),a.add=function(){d.open({animation:a.animationsEnabled,templateUrl:dasApp.baseUrl+"assets/dashboard/views/groups/form.html",controller:"addGroupController",size:"lg",resolve:{options:{title:"Add Group",isEdit:!1},groupRepo:e,group:{}}}).result.then(function(b){a.gridOptions.data.push(b)},function(){})},a.edit=function(b){b=copy_object(b),a.group=b,d.open({animation:a.animationsEnabled,templateUrl:dasApp.baseUrl+"assets/dashboard/views/groups/form.html",controller:"addGroupController",size:"lg",resolve:{options:{title:"Edit Group",isEdit:!0},groupRepo:e,group:b}}).result.then(function(a){},function(){delete_copy(a.group)})},a.delete=function(b){a.group=b,a.modalInstance=d.open({animation:a.animationsEnabled,templateUrl:"DeleteDialog.html",scope:a})},a.confirm_delete=function(){group=a.group,e.delete(group.id).then(function(b){var c=a.gridOptions.data.indexOf(group);a.gridOptions.data.splice(c,1),a.gridOptions.totalItems=a.gridOptions.totalItems-1,a.modalInstance.close()},function(){})},a.cancel=function(){a.modalInstance.dismiss("cancel")}}]),dasApp.controller("imageGalleryController",["$scope","$http","entityManager","$uibModal",function(a,b,c,d){a.title="Image Gallerys",a.isLoading={grid:!0},a.gridOptions={useExternalPagination:!0,paginationPageSizes:[10,15,30],paginationPageSize:10,rowSelection:!0,columnDefs:[{minWidth:120,field:"name",displayName:"Name"},{minWidth:200,field:"title_en",displayName:"Title En"},{minWidth:200,field:"title_ar",displayName:"Title Ar"},{width:120,pinnedRight:!0,name:"Actions",cellTemplate:'<div> &nbsp;<button class="btn btn-xs btn-success" uib-tooltip="Edit" tooltip-placement="right" ng-click="grid.appScope.edit(row.entity)"><i class="fa fa-pencil"></i></button> <button class="btn btn-xs btn-danger" uib-tooltip="Delete" tooltip-placement="bottom" ng-click="grid.appScope.delete(row.entity)"><i class="fa fa-trash"></i></button></div>'}],data:[],onRegisterApi:function(b){b.pagination.on.paginationChanged(a,function(b,c){a.isLoading.grid=!0,e.loadAll(b,c).then(function(b){a.isLoading.grid=!1,a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total})})}},a.isLoading.grid=!0;var e=new c(dasApp.apiBase+"image_gallery/","id",{data:"results"});e.loadAll().then(function(b){a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total,a.isLoading.grid=!1}),a.edit=function(b){b=copy_object(b),a.add(!0,b)},a.add=function(b,c){a.model=c,d.open({animation:a.animationsEnabled,templateUrl:dasApp.baseUrl+"assets/dashboard/views/image_gallery/form.html",controller:"addImageGalleryController",size:"lg",resolve:{options:{title:(b?"Edit":"Add")+" Image Gallery",isEdit:!!b},modelManager:e,model:b?c:{}}}).result.then(function(c){b||a.gridOptions.data.push(c)},function(){delete_copy(a.model)})},a.delete=function(b){a.model=b,a.modalInstance=d.open({animation:a.animationsEnabled,templateUrl:"DeleteDialog.html",scope:a})},a.confirm_delete=function(){model=a.model,e.delete(model.id).then(function(b){var c=a.gridOptions.data.indexOf(model);a.gridOptions.data.splice(c,1),a.gridOptions.totalItems=a.gridOptions.totalItems-1,a.modalInstance.close()},function(){})},a.cancel=function(){a.modalInstance.dismiss("cancel")}}]),dasApp.controller("menuController",["$scope","$http","entityManager",function(a,b,c){a.title="menu",a.sections=[];var d=[];return d.push({field:"sections.show_in_menu",value:"1"}),new c(dasApp.apiBase+"sections/","section_id",{data:"results"}).search(d).then(function(b){a.sections=b.results})}]),dasApp.controller("menuItemsController",["$scope","$http","entityManager","$uibModal",function(a,b,c,d){function e(b,c){a.isLoading.grid=!0,f.loadAll(b,c).then(function(b){angular.forEach(b,function(a,b){a.product_name=a.product_name_en+" | "+a.product_name_ar}),a.gridOptions.data=b,a.gridOptions.totalItems=b.length,a.isLoading.grid=!1})}a.title="Menu Items",a.isLoading={grid:!0},a.msg="",a.err=!1,a.gridOptions={useExternalPagination:!1,paginationPageSizes:[20,50,100],paginationPageSize:50,enableRowSelection:!1,enableRowHeaderSelection:!1,rowSelection:!1,multiSelect:!1,enableGridMenu:!0,enableSelectAll:!0,exporterCsvFilename:"menuItems.csv",exporterPdfDefaultStyle:{fontSize:9},exporterPdfTableStyle:{margin:[30,30,30,30]},exporterPdfTableHeaderStyle:{fontSize:10,bold:!0,italics:!0,color:"red"},exporterPdfHeader:{text:"menuItems",style:"headerStyle"},exporterPdfFooter:function(a,b){return{text:a.toString()+" of "+b.toString(),style:"footerStyle"}},exporterPdfCustomFormatter:function(a){return a.styles.headerStyle={fontSize:22,bold:!0},a.styles.footerStyle={fontSize:10,bold:!0},a},exporterPdfOrientation:"portrait",exporterPdfPageSize:"LETTER",exporterPdfMaxGridWidth:500,exporterCsvLinkElement:angular.element(document.querySelectorAll(".custom-csv-link-location")),columnDefs:[{minWidth:120,field:"product_name",name:"Product Name"},{width:120,field:"qty",name:"Quantity"},{width:120,field:"total",name:"Total"}],data:[],onRegisterApi:function(b){a.gridApi=b}};var f=new c(dasApp.apiBase+"reports/menu_items","report_id",{data:"results"});a.isLoading.grid=!0,e(1,1e3),a.refreshGrid=function(){e(1,1e3)},a.branches=[],new c(dasApp.apiBase+"branches/","branch_id",{data:"results"}).loadAll(1,100).then(function(b){a.branches=b.results}),a.dateOptions={formatYear:"yy",startingDay:1,maxDate:new Date},a.maxDate=new Date,a.maxDate2=new Date,a.formats=["yyyy-MM-dd"],a.format=a.formats[0],a.popup1={opened:!1},a.popup2={opened:!1},a.search={branch:"",fromdate:"",todate:""},a.showSearch=!1,a.toggleSearchBox=function(){a.showSearch=!a.showSearch,a.showSearch||(a.search={branch:"",fromdate:"",todate:""},a.doSearch())},a.doSearch=function(){window.xx=a.search;var b=[];if(a.search.branch&&""!=a.search.branch.trim()&&b.push({field:"orders.branch_id",value:a.search.branch,op:"eq"}),a.search.fromdate&&""!=a.search.fromdate){a.minDate2=a.search.fromdate;var c=a.search.fromdate,d=c.getFullYear()+"-"+(c.getMonth()+1)+"-"+c.getDate();b.push({field:"orders.order_date",value:d,op:"gt"})}if(a.search.todate&&""!=a.search.todate){a.maxDate2=a.search.todate;var c=a.search.todate,d=c.getFullYear()+"-"+(c.getMonth()+1)+"-"+c.getDate();b.push({field:"orders.order_date",value:d,op:"ls"})}return a.isLoading.grid=!0,f.search(b).then(function(b){angular.forEach(b,function(a,b){a.product_name=a.product_name_en+" | "+a.product_name_ar}),a.gridOptions.data=b,a.gridOptions.totalItems=b.length,a.isLoading.grid=!1})},a.checkClear=function(){null!=a.search.todate&&""!=a.search.todate||(a.maxDate2=new Date),null!=a.search.fromdate&&""!=a.search.fromdate||(a.minDate2="")},a.export=function(){var b=angular.element(document.querySelectorAll(".custom-csv-link-location"));a.gridApi.exporter.csvExport("all","visible",b)}}]),dasApp.controller("menusController",["$scope","$http","entityManager","$uibModal",function(a,b,c,d){a.title="Menus",a.isLoading={grid:!0},a.gridOptions={useExternalPagination:!0,paginationPageSizes:[10,15,30],paginationPageSize:10,rowSelection:!0,columnDefs:[{minWidth:200,field:"menu_name_en",displayName:"Menu Name En"},{minWidth:200,field:"menu_name_en",displayName:"Menu Name Ar"},{width:120,pinnedRight:!0,name:"Actions",cellTemplate:'<div> &nbsp;<button class="btn btn-xs btn-success" uib-tooltip="Edit Menu" tooltip-placement="right" ng-click="grid.appScope.edit(row.entity)"><i class="fa fa-pencil"></i></button> <button class="btn btn-xs btn-danger" uib-tooltip="Delete Menu" tooltip-placement="bottom" ng-click="grid.appScope.delete(row.entity)"><i class="fa fa-trash"></i></button></div>'}],data:[],onRegisterApi:function(b){b.pagination.on.paginationChanged(a,function(b,c){a.isLoading.grid=!0,e.loadAll(b,c).then(function(b){a.isLoading.grid=!1,a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total})})}},a.isLoading.grid=!0;var e=new c(dasApp.apiBase+"menu/","menu_id",{data:"results"});e.loadAll().then(function(b){a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total,a.isLoading.grid=!1}),a.edit=function(b){b=copy_object(b),a.add(!0,b)},a.add=function(b,c){a.menu=c,d.open({animation:a.animationsEnabled,templateUrl:dasApp.baseUrl+"assets/dashboard/views/menu/form.html",controller:"addMenuController",size:"lg",resolve:{options:{title:(b?"Edit":"Add")+" Menu",isEdit:!!b},menuManager:e,menu:b?c:{}}}).result.then(function(c){b||a.gridOptions.data.push(c)},function(){delete_copy(a.menu)})},a.delete=function(b){a.menu=b,a.modalInstance=d.open({animation:a.animationsEnabled,templateUrl:"DeleteDialog.html",scope:a})},a.confirm_delete=function(){menu=a.menu,e.delete(menu.menu_id).then(function(b){var c=a.gridOptions.data.indexOf(menu);a.gridOptions.data.splice(c,1),a.gridOptions.totalItems=a.gridOptions.totalItems-1,a.modalInstance.close()},function(){})},a.cancel=function(){a.modalInstance.dismiss("cancel")}}]),dasApp.controller("modelsController",["$scope","$http","entityManager","$uibModal","toaster","data",function(a,b,c,d,e,f){function g(){for(var b=0;b<f.tabs.length;b++)for(var c=f.tabs[b],d=0;d<c.fields.length;d++){var e=c.fields[d];1==e.search&&(a.search[e.field]="",a.fieldssearch.push(e))}a.fieldssearch.length>0&&(a.issearch=!0)}a.title=f.title,a.isLoading={grid:!0},a.msg="",a.err=!1,a.models=[],a.events=[],a.ready=!1,a.allowadd=0!=f.allowadd,a.allowrefresh=0!=f.allowrefresh;for(var h=[],i=0;i<f.tabs.length;i++)for(var j=f.tabs[i],k=0;k<j.fields.length;k++){var l=j.fields[k];l.show&&"grid"!=l.show||("checkbox"==l.type?h.push({field:l.field,name:l.name,cellTemplate:'<div class="ui-grid-cell-contents" title="TOOLTIP"><div  ng-if="row.entity.'+l.field+' == 0 " ><span class="label label-danger">No</span></div><div  ng-if="row.entity.'+l.field+' == 1 " ><span class="label label-success">Yes</span></div></div>'}):h.push({field:l.field,name:l.name}))}h.push({width:120,pinnedRight:!0,name:"Actions",cellTemplate:"<div>"+(f.allowview?'<button class="btn btn-xs btn-primary" uib-tooltip="View Data" tooltip-placement="right" ng-click="grid.appScope.view(row.entity)"><i class="fa fa-eye"></i></button> ':"")+'<button class="btn btn-xs btn-success" uib-tooltip="Edit Data" tooltip-placement="right" ng-click="grid.appScope.edit(row.entity)"><i class="fa fa-edit"></i></button> <button class="btn btn-xs btn-danger" uib-tooltip="Delete" tooltip-placement="bottom" ng-click="grid.appScope.delete(row.entity)"><i class="fa fa-trash"></i></button></div>'}),a.gridOptions={useExternalPagination:!0,paginationPageSizes:[10,15,30],paginationPageSize:10,rowSelection:!0,columnDefs:h,data:[],onRegisterApi:function(b){b.pagination.on.paginationChanged(a,function(b,c){a.isLoading.grid=!0,m.loadAll(b,c).then(function(b){a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total,a.isLoading.grid=!1,a.ready=!0})})}},a.isLoading.grid=!0;var m=new c(dasApp.apiBase+f.apiname+"/","id",{data:"results"});m.loadAll().then(function(b){a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total,a.isLoading.grid=!1,a.models=b.results}),a.view=function(b){a.model=b,d.open({animation:a.animationsEnabled,templateUrl:dasApp.baseUrl+"assets/dashboard/views/"+f.viewfolder+"/view.html",controller:"addModelController",size:"lg",resolve:{options:{title:"View "+f.title},modelManager:m,model:b,data:f}}).result.then(function(){},function(){delete_copy(a.model)})},a.delete=function(b){a.model=b,a.modalInstance=d.open({animation:a.animationsEnabled,templateUrl:"DeleteDialog.html",scope:a})},a.confirm_delete=function(){model=a.model,m.delete(model.id).then(function(b){if(0==b.data.success)a.err=!0,a.msg=b.data.msg;else{var c=a.gridOptions.data.indexOf(model);a.gridOptions.data.splice(c,1),a.gridOptions.totalItems=a.gridOptions.totalItems-1,a.modalInstance.close()}},function(){})},a.cancel=function(){a.modalInstance.dismiss("cancel")},a.edit=function(b){b=copy_object(b),a.add(!0,b)},a.add=function(b,c){a.model=c;for(var e={},g=0;g<f.tabs.length;g++){var h=f.tabs[g];if(h.grids)for(var i=0;i<h.grids.length;i++){var j=h.grids[i];e[j.field]=[]}}d.open({animation:a.animationsEnabled,templateUrl:dasApp.baseUrl+"assets/dashboard/views/models/form.html",controller:"addModelController",size:"lg",resolve:{options:{title:(b?"Edit ":"Add ")+f.title,isEdit:!!b},modelManager:m,model:b?c:e,data:f}}).result.then(function(c){b||a.gridOptions.data.push(c)},function(){b&&delete_copy(a.model)})},a.refresh=function(){a.isLoading.grid=!0,m.loadAll().then(function(b){a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total,a.isLoading.grid=!1})},a.fieldssearch=[],a.search={},a.issearch=!1,g(),a.showSearch=!1,a.toggleSearchBox=function(){if(a.showSearch=!a.showSearch,!a.showSearch){for(var b=0;b<a.fieldssearch.length;b++)a.search[a.fieldssearch[b].field]="";a.doSearch()}},a.doSearch=function(){a.isLoading.grid=!0;for(var b=[],c=0;c<a.fieldssearch.length;c++){var d=a.fieldssearch[c],e="orlike";0==c&&(e="like"),""!=a.search[d.field].trim()&&b.push({field:f.tablename+"."+d.field,value:a.search[d.field],op:e})}return m.search(b,a.newPage,a.pageSize).then(function(b){a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total,a.isLoading.grid=!1})}}]),dasApp.controller("pagesController",["$scope","$http","entityManager","$uibModal","$routeParams",function(a,b,c,d,e){var f=e.section_id;if(a.is_section=!1,a.isLoading={grid:!0},a.pageSize=10,a.newPage=1,void 0!==f){a.is_section=!0;var g=[];g.push({field:"sections.section_id",value:f});var h=new c(dasApp.apiBase+"sections/","section_id",{data:"results"});h.search(g).then(function(b){a.title=b.results[0].section_title_en})}else a.title="Pages";a.gridOptions={useExternalPagination:!0,paginationPageSizes:[10,15,30],paginationPageSize:10,rowSelection:!0,columnDefs:[{width:120,field:"page_title_en",displayName:"Title En"},{width:120,field:"page_title_ar",displayName:"Title Ar"},{width:120,field:"page_slug",displayName:"Slug"},{width:120,field:"section_title_en",displayName:"Section Title En"},{width:120,field:"section_title_ar",displayName:"Section Title Ar"},{minWidth:200,field:"page_description_en",displayName:"Description En"},{minWidth:200,field:"page_description_ar",displayName:"Description Ar"},{width:120,pinnedRight:!0,name:"Actions",cellTemplate:'<div><button class="btn btn-xs btn-success" uib-tooltip="Edit Page" tooltip-placement="right" ng-click="grid.appScope.edit(row.entity)"><i class="fa fa-pencil"></i></button> <button class="btn btn-xs btn-danger" uib-tooltip="Delete Page" tooltip-placement="bottom" ng-click="grid.appScope.delete(row.entity)"><i class="fa fa-trash"></i></button></div>'}],data:[],onRegisterApi:function(b){b.pagination.on.paginationChanged(a,function(b,c){if(a.pageSize=c,a.newPage=b,a.isLoading.grid=!0,1==a.is_section){var d=[];d.push({field:"pages.section_id",value:f}),i.search(d).then(function(b){a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total,a.isLoading.grid=!1})}else i.loadAll(b,c).then(function(b){a.isLoading.grid=!1,a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total})})}},a.isLoading.grid=!0,a.selectedSection={},a.selectedSectionChanged=function(b){a.search.section_id=b.section_id,a.selectedSection=b,a.doSearch()};var i=new c(dasApp.apiBase+"pages/","page_id",{data:"results"});if(1==a.is_section){var g=[];g.push({field:"pages.section_id",value:f}),i.search(g).then(function(b){a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total,a.isLoading.grid=!1})}else i.loadAll().then(function(b){a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total,a.isLoading.grid=!1});a.sections=[];var h=new c(dasApp.apiBase+"sections","section_id");h.loadAll().then(function(b){a.sections=b.results}),a.sectionsTree=[],new c(dasApp.apiBase+"sections/tree","section_id").loadAll().then(function(b){a.sectionsTree=b.results}),a.search={page_title:"",page_description:"",section_id:0},a.showSearch=!1,a.toggleSearchBox=function(){a.showSearch=!a.showSearch,a.showSearch||(a.search={page_title:"",page_description:"",section_id:0},a.doSearch())},a.doSearch=function(){var b=[];return""!=a.search.page_title.trim()&&(b.push({field:"pages.page_title_en",value:a.search.page_title,op:"like"}),b.push({field:"pages.page_title_ar",value:a.search.page_title,op:"orlike"})),""!=a.search.page_description.trim()&&(b.push({field:"pages.page_description_en",value:a.search.page_description,op:"orlike"}),b.push({field:"pages.page_description_ar",value:a.search.page_description,op:"orlike"})),a.search.section_id&&b.push({field:"pages.section_id",value:a.search.section_id,op:"eq"}),a.isLoading.grid=!0,i.search(b,a.newPage,a.pageSize).then(function(b){a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total,a.isLoading.grid=!1})},a.edit=function(b){b=copy_object(b),a.add(!0,b)},a.add=function(b,c){a.page=c,d.open({animation:a.animationsEnabled,templateUrl:dasApp.baseUrl+"assets/dashboard/views/pages/form.html",controller:"addPageController",size:"lg",resolve:{options:{title:(b?"Edit":"Add")+" Page",isEdit:!!b,is_section:a.is_section,section_id:f,section:a.selectedSection},pagesManager:i,page:b?c:{section_id:a.selectedSection.section_id,custom_fields:[],custom_field_values:[]}}}).result.then(function(c){b||a.gridOptions.data.push(c)},function(){delete_copy(a.page)})},a.delete=function(b){a.page=b,a.modalInstance=d.open({animation:a.animationsEnabled,templateUrl:"DeleteDialog.html",scope:a})},a.confirm_delete=function(){page=a.page,i.delete(page.page_id).then(function(b){var c=a.gridOptions.data.indexOf(page);a.gridOptions.data.splice(c,1),a.gridOptions.totalItems=a.gridOptions.totalItems-1,a.modalInstance.close()},function(){})},a.cancel=function(){a.modalInstance.dismiss("cancel")}}]),dasApp.controller("productsController",["$scope","$http","entityManager","$uibModal","$window",function(a,b,c,d,e){a.title="Products",a.isLoading={grid:!0},a.pageSize=10,a.newPage=1,a.gridOptions={useExternalPagination:!0,paginationPageSizes:[10,15,30],paginationPageSize:10,rowSelection:!0,rowHeight:128,columnDefs:[{width:120,field:"product_image_en",displayName:"Image En",cellTemplate:'<div class="ui-grid-cell-contents" title="TOOLTIP"><img src="{{row.entity.thumb_en}}" class="img-responsive"></div>'},{width:120,field:"product_image_ar",displayName:"Image Ar",cellTemplate:'<div class="ui-grid-cell-contents" title="TOOLTIP"><img src="{{row.entity.thumb_ar}}" class="img-responsive"></div>'},{width:120,field:"product_name_en",displayName:"Name En"},{width:120,field:"product_name_ar",displayName:"Name Ar"},{width:120,cellTemplate:'<div class="ui-grid-cell-contents" title="TOOLTIP">{{row.entity.category_name_ar}} | {{row.entity.category_name_en}}</div>',field:"category_name_ar",name:"Category"},{width:120,field:"product_price",displayName:"Price"},{minWidth:200,field:"product_description_en",displayName:"Description En"},{minWidth:200,field:"product_description_ar",displayName:"Description Ar"},{width:120,pinnedRight:!0,name:"Actions",cellTemplate:'<div><button class="btn btn-xs btn-success" uib-tooltip="Edit Product" tooltip-placement="right" ng-click="grid.appScope.edit(row.entity)"><i class="fa fa-pencil"></i></button> <button class="btn btn-xs btn-danger" uib-tooltip="Delete Product" tooltip-placement="bottom" ng-click="grid.appScope.delete(row.entity)"><i class="fa fa-trash"></i></button></div>'}],data:[],onRegisterApi:function(b){b.pagination.on.paginationChanged(a,function(b,c){a.pageSize=c,a.newPage=b,a.isLoading.grid=!0,f.loadAll(b,c).then(function(b){a.isLoading.grid=!1,a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total})})}},a.isLoading.grid=!0;var f=new c(dasApp.apiBase+"products/","product_id",{data:"results"});f.loadAll().then(function(b){a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total,a.isLoading.grid=!1}),a.categories=[],new c(dasApp.apiBase+"categories","category_id").loadAll().then(function(b){a.categories=b.results}),a.search={product_name:"",product_description:"",category_id:0},a.showSearch=!1,a.toggleSearchBox=function(){a.showSearch=!a.showSearch,a.showSearch||(a.search={product_name:"",product_description:"",category_id:0},a.doSearch())},a.doSearch=function(){a.isLoading.grid=!0;var b=[];return""!=a.search.product_name.trim()&&(b.push({field:"products.product_name_en",value:a.search.product_name,op:"like"}),b.push({field:"products.product_name_ar",value:a.search.product_name,op:"orlike"})),""!=a.search.product_description.trim()&&(b.push({field:"products.product_description_en",value:a.search.product_description,op:"orlike"}),b.push({field:"products.product_description_ar",value:a.search.product_description,op:"orlike"})),a.search.category_id&&b.push({field:"products.category_id",value:a.search.category_id,op:"eq"}),f.search(b,a.newPage,a.pageSize).then(function(b){a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total,a.isLoading.grid=!1})},a.edit=function(b){b=copy_object(b),a.add(!0,b)},a.add=function(b,c){a.product=c,d.open({animation:a.animationsEnabled,templateUrl:dasApp.baseUrl+"assets/dashboard/views/products/form.html",controller:"addProductController",size:"lg",resolve:{options:{title:(b?"Edit":"Add")+" Product",isEdit:!!b},productsManager:f,product:b?c:{}}}).result.then(function(c){b||a.gridOptions.data.push(c)},function(){delete_copy(a.product)})},a.delete=function(b){a.product=b,a.modalInstance=d.open({animation:a.animationsEnabled,templateUrl:"DeleteDialog.html",scope:a})},a.confirm_delete=function(){product=a.product,f.delete(product.product_id).then(function(b){var c=a.gridOptions.data.indexOf(product);a.gridOptions.data.splice(c,1),a.gridOptions.totalItems=a.gridOptions.totalItems-1,a.modalInstance.close()},function(){})},a.cancel=function(b){a.modalInstance.dismiss("cancel")},a.refresh=function(){a.isLoading.grid=!0,products.loadAll().then(function(b){a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total,a.isLoading.grid=!1})}}]),dasApp.controller("sectionsController",["$scope","$http","entityManager","$uibModal",function(a,b,c,d){function e(){a.isLoading.grid=!0,a.gridOptions.data=[],g.loadAll(1,100).then(function(b){a.sections=b.results;f(a.sections,0,a.gridOptions.data);a.gridOptions.totalItems=a.gridOptions.data.length,a.isLoading.grid=!1})}a.title="Sections",a.msg="",a.err=!1,a.isLoading={grid:!0},a.gridOptions={useExternalPagination:!0,paginationPageSizes:[10,15,30],paginationPageSize:10,showTreeExpandNoChildren:!1,rowSelection:!0,columnDefs:[{width:130,field:"section_title_en",name:"Name En"},{width:130,field:"section_title_ar",name:"Name Ar"},{width:130,field:"section_slug",name:"Slug"},{minWidth:200,field:"section_description_en",name:"Description En"},{minWidth:200,field:"section_description_ar",name:"Description Ar"},{width:120,pinnedRight:!0,name:"Actions",cellTemplate:'<div><button class="btn btn-xs btn-success" uib-tooltip="Edit Section" tooltip-placement="right" ng-click="grid.appScope.edit(row.entity)"><i class="fa fa-pencil"></i></button> <button class="btn btn-xs btn-danger" uib-tooltip="Delete Section" tooltip-placement="bottom" ng-click="grid.appScope.delete(row.entity)"><i class="fa fa-trash"></i></button></div>'}],data:[],onRegisterApi:function(b){a.gridApi=b,a.gridApi.treeBase.on.rowExpanded(a,function(a){}),b.pagination.on.paginationChanged(a,function(a,b){})}};var f=function(a,b,c){a.forEach(function(a){a.$$treeLevel=b,c.push(a),f(a.sections,b+1,c)})},g=new c(dasApp.apiBase+"sections/tree/","section_id",{data:"results"}),h=new c(dasApp.apiBase+"sections/","section_id",{data:"results"});e(),a.search={},a.showSearch=!1,a.toggleSearchBox=function(){a.showSearch=!a.showSearch,a.showSearch||(a.search={},a.doSearch())},a.doSearch=function(){var b=[];return h.search(b).then(function(b){a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total})},a.edit=function(b){b=copy_object(b),a.add(!0,b)},a.add=function(b,c){a.section=c,d.open({animation:a.animationsEnabled,templateUrl:dasApp.baseUrl+"assets/dashboard/views/sections/form.html",controller:"addSectionController",size:"lg",resolve:{options:{title:(b?"Edit":"Add")+" Section",isEdit:!!b},sectionsManager:h,section:b?c:{custom_fields:[]}}}).result.then(function(c){b||a.gridOptions.data.push(c),e()},function(){delete_copy(a.section)})},a.delete=function(b){a.section=b,a.modalInstance=d.open({animation:a.animationsEnabled,templateUrl:"DeleteDialog.html",scope:a})},a.confirm_delete=function(){section=a.section,h.delete(section.section_id).then(function(b){var c=a.gridOptions.data.indexOf(section);a.gridOptions.data.splice(c,1),a.gridOptions.totalItems=a.gridOptions.totalItems-1,a.modalInstance.close()},function(){})},a.cancel=function(){a.modalInstance.dismiss("cancel")},a.refresh=function(){products.loadAll().then(function(b){a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total})}}]),dasApp.controller("slidersController",["$scope","$http","entityManager","$uibModal",function(a,b,c,d){a.title="Sliders",a.isLoading={grid:!0},a.gridOptions={useExternalPagination:!0,paginationPageSizes:[10,15,30],paginationPageSize:10,rowSelection:!0,columnDefs:[{minWidth:120,field:"slider_name",displayName:"Slider Name"},{minWidth:200,field:"slider_title_en",displayName:"Title En"},{minWidth:200,field:"slider_title_ar",displayName:"Title Ar"},{width:120,pinnedRight:!0,name:"Actions",cellTemplate:'<div> &nbsp;<button class="btn btn-xs btn-success" uib-tooltip="Edit Slider" tooltip-placement="right" ng-click="grid.appScope.edit(row.entity)"><i class="fa fa-pencil"></i></button> <button class="btn btn-xs btn-danger" uib-tooltip="Delete Slider" tooltip-placement="bottom" ng-click="grid.appScope.delete(row.entity)"><i class="fa fa-trash"></i></button></div>'}],data:[],onRegisterApi:function(b){b.pagination.on.paginationChanged(a,function(b,c){a.isLoading.grid=!0,e.loadAll(b,c).then(function(b){a.isLoading.grid=!1,a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total})})}},a.isLoading.grid=!0;var e=new c(dasApp.apiBase+"sliders/","slider_id",{data:"results"});e.loadAll().then(function(b){a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total,a.isLoading.grid=!1}),a.edit=function(b){b=copy_object(b),a.add(!0,b)},a.add=function(b,c){a.slider=c,d.open({animation:a.animationsEnabled,templateUrl:dasApp.baseUrl+"assets/dashboard/views/sliders/form.html",controller:"addSliderController",size:"lg",resolve:{options:{title:(b?"Edit":"Add")+" Slider",isEdit:!!b},slidersManager:e,slider:b?c:{}}}).result.then(function(c){b||a.gridOptions.data.push(c)},function(){delete_copy(a.slider)})},a.delete=function(b){a.slider=b,a.modalInstance=d.open({animation:a.animationsEnabled,templateUrl:"DeleteDialog.html",scope:a})},a.confirm_delete=function(){slider=a.slider,e.delete(slider.slider_id).then(function(b){var c=a.gridOptions.data.indexOf(slider);a.gridOptions.data.splice(c,1),a.gridOptions.totalItems=a.gridOptions.totalItems-1,a.modalInstance.close()},function(){})},a.cancel=function(){a.modalInstance.dismiss("cancel")}}]),dasApp.controller("usersController",["$scope","$http","entityManager","$uibModal","$routeParams",function(a,b,c,d,e){a.title="Users";var f=e.members;a.is_member=!1,void 0!==f&&(a.is_member=!0,a.title="Members"),a.isLoading={grid:!0},a.pageSize=10,a.newPage=1,a.gridOptions={paginationPageSizes:[10,15,30],paginationPageSize:10,enableRowSelection:!0,enableRowHeaderSelection:!1,multiSelect:!1,columnDefs:[{minWidth:120,field:"username",displayName:"Username"},{width:120,field:"first_name",displayName:"First Name"},{width:120,field:"last_name",displayName:"Last Name"},{width:150,field:"email",displayName:"Email"},{width:120,field:"group_name",displayName:"Group"},{width:100,field:"phone",displayName:"Phone"},{width:130,pinnedRight:!0,name:"Actions",cellTemplate:'<div> <button class="btn btn-xs btn-warning"  ng-hide="grid.appScope.is_member" tooltip-placement="right" uib-tooltip="Assign User to Group" ng-click="grid.appScope.assign_group(row.entity)"><i class="fa fa-plus"></i></button> <button class="btn btn-xs btn-success" uib-tooltip="Edit User" tooltip-placement="right" ng-click="grid.appScope.edit(row.entity)"><i class="fa fa-pencil"></i></button> <button class="btn btn-xs btn-danger"   uib-tooltip="Delete User" tooltip-placement="bottom" ng-click="grid.appScope.delete(row.entity)"><i class="fa fa-trash"></i></button> </div>'}],data:[],onRegisterApi:function(b){b.pagination.on.paginationChanged(a,function(b,c){if(a.pageSize=c,a.newPage=b,a.isLoading.grid=!0,1==a.is_member){var d=[];d.push({field:"users_groups.group_id",value:"4"}),d.push({field:"users.is_deleted",value:"0"}),g.search(d).then(function(b){a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total,a.isLoading.grid=!1})}else{var d=[];d.push({field:"users_groups.group_id",value:"4",op:"noteq"}),d.push({field:"users.is_deleted",value:"0"}),g.search(d).then(function(b){a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total,
a.isLoading.grid=!1})}})}},a.isLoading.grid=!0;var g=new c(dasApp.apiBase+"users/","id",{data:"results"});if(1==a.is_member){var h=[];h.push({field:"users_groups.group_id",value:"4"}),h.push({field:"users.is_deleted",value:"0"}),g.search(h).then(function(b){a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total,a.isLoading.grid=!1})}else{var h=[];h.push({field:"users_groups.group_id",value:"4",op:"noteq"}),h.push({field:"users.is_deleted",value:"0"}),g.search(h).then(function(b){a.gridOptions.data=b.results,a.gridOptions.totalItems=b.total,a.isLoading.grid=!1})}a.groups=[],new c(dasApp.apiBase+"groups","id").loadAll().then(function(b){a.groups=b.results}),a.search={first_name:"",last_name:"",group_id:"",email:""},a.is_member&&(a.search={first_name:"",last_name:"",group_id:"4",email:""}),a.showSearch=!1,a.toggleSearchBox=function(){a.showSearch=!a.showSearch,a.showSearch||(a.search={first_name:"",last_name:"",group_id:"",email:""},a.doSearch())},a.doSearch=function(){var b=[];if(""!=a.search.first_name.trim()&&b.push({field:"users.first_name",value:a.search.first_name,op:"like"}),a.search.last_name&&b.push({field:"users.last_name",value:a.search.last_name,op:"like"}),""!=a.search.group_id.trim()&&b.push({field:"users_groups.group_id",value:a.search.group_id,op:"like"}),a.search.email&&b.push({field:"users.email",value:a.search.email,op:"like"}),b.length<=0)if(0==a.is_member){var b=[];b.push({field:"users_groups.group_id",value:"4",op:"noteq"})}else{var b=[];b.push({field:"users_groups.group_id",value:"4"})}return g.search(b,a.newPage,a.pageSize).then(function(b){a.gridOptions.data=b.results})},a.add=function(){d.open({animation:a.animationsEnabled,templateUrl:dasApp.baseUrl+"assets/dashboard/views/users/form.html",controller:"addUserController",size:"lg",resolve:{options:{title:"Add User",isEdit:!1,is_member:a.is_member},userRepo:g,user:{}}}).result.then(function(b){a.gridOptions.data.push(b)},function(){})},a.edit=function(b){b=copy_object(b),a.user=b,d.open({animation:a.animationsEnabled,templateUrl:dasApp.baseUrl+"assets/dashboard/views/users/form_edit.html",controller:"addUserController",size:"lg",resolve:{options:{title:"Edit User",isEdit:!0},userRepo:g,user:b}}).result.then(function(a){},function(){delete_copy(a.user)})},a.delete=function(b){a.user=b,a.modalInstance=d.open({animation:a.animationsEnabled,templateUrl:"DeleteDialog.html",scope:a})},a.confirm_delete=function(){user=a.user,g.delete(user.id).then(function(b){var c=a.gridOptions.data.indexOf(user);a.gridOptions.data.splice(c,1),a.gridOptions.totalItems=a.gridOptions.totalItems-1,a.modalInstance.close()},function(){})},a.cancel=function(){a.modalInstance.dismiss("cancel")},a.assign_group=function(b){d.open({animation:a.animationsEnabled,templateUrl:dasApp.baseUrl+"assets/dashboard/views/users/assign_group.html",controller:"assignGroupController",size:"lg",resolve:{options:{title:"Assign Group"},userRepo:g,user:b}}).result.then(function(a){},function(){})}}]);